!function(n){var r={};function t(e){if(r[e])return r[e].exports;var o=r[e]={i:e,l:!1,exports:{}};return n[e].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=n,t.c=r,t.d=function(n,r,e){t.o(n,r)||Object.defineProperty(n,r,{enumerable:!0,get:e})},t.r=function(n){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,r){if(1&r&&(n=t(n)),8&r)return n;if(4&r&&"object"===typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(t.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&r&&"string"!=typeof n)for(var o in n)t.d(e,o,function(r){return n[r]}.bind(null,o));return e},t.n=function(n){var r=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(r,"a",r),r},t.o=function(n,r){return Object.prototype.hasOwnProperty.call(n,r)},t.p="/adage-frontend/",t(t.s=14)}([function(n,r,t){n.exports=function(){var n=function(n,r){var t=Array.prototype.concat,e=Array.prototype.slice,o=Object.prototype.toString;function u(r,t){var e=r>t?r:t;return n.pow(10,17-~~(n.log(e>0?e:-e)*n.LOG10E))}var a=Array.isArray||function(n){return"[object Array]"===o.call(n)};function i(n){return"[object Function]"===o.call(n)}function f(n){return"number"===typeof n&&n-n===0}function c(){return new c._init(arguments)}function l(){return 0}function s(){return 1}function p(n,r){return n===r?1:0}c.fn=c.prototype,c._init=function(n){if(a(n[0]))if(a(n[0][0])){i(n[1])&&(n[0]=c.map(n[0],n[1]));for(var r=0;r<n[0].length;r++)this[r]=n[0][r];this.length=n[0].length}else this[0]=i(n[1])?c.map(n[0],n[1]):n[0],this.length=1;else if(f(n[0]))this[0]=c.seq.apply(null,n),this.length=1;else{if(n[0]instanceof c)return c(n[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:u,isArray:a,isFunction:i,isNumber:f,toVector:function(n){return t.apply([],n)}},c._random_fn=n.random,c.setRandom=function(n){if("function"!==typeof n)throw new TypeError("fn is not a function");c._random_fn=n},c.extend=function(n){var r,t;if(1===arguments.length){for(t in n)c[t]=n[t];return this}for(r=1;r<arguments.length;r++)for(t in arguments[r])n[t]=arguments[r][t];return n},c.rows=function(n){return n.length||1},c.cols=function(n){return n[0].length||1},c.dimensions=function(n){return{rows:c.rows(n),cols:c.cols(n)}},c.row=function(n,r){return a(r)?r.map((function(r){return c.row(n,r)})):n[r]},c.rowa=function(n,r){return c.row(n,r)},c.col=function(n,r){if(a(r)){var t=c.arange(n.length).map((function(){return new Array(r.length)}));return r.forEach((function(r,e){c.arange(n.length).forEach((function(o){t[o][e]=n[o][r]}))})),t}for(var e=new Array(n.length),o=0;o<n.length;o++)e[o]=[n[o][r]];return e},c.cola=function(n,r){return c.col(n,r).map((function(n){return n[0]}))},c.diag=function(n){for(var r=c.rows(n),t=new Array(r),e=0;e<r;e++)t[e]=[n[e][e]];return t},c.antidiag=function(n){for(var r=c.rows(n)-1,t=new Array(r),e=0;r>=0;r--,e++)t[e]=[n[e][r]];return t},c.transpose=function(n){var r,t,e,o,u,i=[];for(a(n[0])||(n=[n]),t=n.length,e=n[0].length,u=0;u<e;u++){for(r=new Array(t),o=0;o<t;o++)r[o]=n[o][u];i.push(r)}return 1===i.length?i[0]:i},c.map=function(n,r,t){var e,o,u,i,f;for(a(n[0])||(n=[n]),o=n.length,u=n[0].length,i=t?n:new Array(o),e=0;e<o;e++)for(i[e]||(i[e]=new Array(u)),f=0;f<u;f++)i[e][f]=r(n[e][f],e,f);return 1===i.length?i[0]:i},c.cumreduce=function(n,r,t){var e,o,u,i,f;for(a(n[0])||(n=[n]),o=n.length,u=n[0].length,i=t?n:new Array(o),e=0;e<o;e++)for(i[e]||(i[e]=new Array(u)),u>0&&(i[e][0]=n[e][0]),f=1;f<u;f++)i[e][f]=r(i[e][f-1],n[e][f]);return 1===i.length?i[0]:i},c.alter=function(n,r){return c.map(n,r,!0)},c.create=function(n,r,t){var e,o,u=new Array(n);for(i(r)&&(t=r,r=n),e=0;e<n;e++)for(u[e]=new Array(r),o=0;o<r;o++)u[e][o]=t(e,o);return u},c.zeros=function(n,r){return f(r)||(r=n),c.create(n,r,l)},c.ones=function(n,r){return f(r)||(r=n),c.create(n,r,s)},c.rand=function(n,r){return f(r)||(r=n),c.create(n,r,c._random_fn)},c.identity=function(n,r){return f(r)||(r=n),c.create(n,r,p)},c.symmetric=function(n){var r,t,e=n.length;if(n.length!==n[0].length)return!1;for(r=0;r<e;r++)for(t=0;t<e;t++)if(n[t][r]!==n[r][t])return!1;return!0},c.clear=function(n){return c.alter(n,l)},c.seq=function(n,r,t,e){i(e)||(e=!1);var o,a=[],f=u(n,r),c=(r*f-n*f)/((t-1)*f),l=n;for(o=0;l<=r&&o<t;l=(n*f+c*f*++o)/f)a.push(e?e(l,o):l);return a},c.arange=function(n,r,t){var e,o=[];if(t=t||1,void 0===r&&(r=n,n=0),n===r||0===t)return[];if(n<r&&t<0)return[];if(n>r&&t>0)return[];if(t>0)for(e=n;e<r;e+=t)o.push(e);else for(e=n;e>r;e+=t)o.push(e);return o},c.slice=function(){function n(n,r,t,e){var o,u=[],a=n.length;if(void 0===r&&void 0===t&&void 0===e)return c.copy(n);if(e=e||1,(r=(r=r||0)>=0?r:a+r)===(t=(t=t||n.length)>=0?t:a+t)||0===e)return[];if(r<t&&e<0)return[];if(r>t&&e>0)return[];if(e>0)for(o=r;o<t;o+=e)u.push(n[o]);else for(o=r;o>t;o+=e)u.push(n[o]);return u}return function(r,t){var e,o;return f((t=t||{}).row)?f(t.col)?r[t.row][t.col]:n(c.rowa(r,t.row),(e=t.col||{}).start,e.end,e.step):f(t.col)?n(c.cola(r,t.col),(o=t.row||{}).start,o.end,o.step):(o=t.row||{},e=t.col||{},n(r,o.start,o.end,o.step).map((function(r){return n(r,e.start,e.end,e.step)})))}}(),c.sliceAssign=function(r,t,e){var o,u;if(f(t.row)){if(f(t.col))return r[t.row][t.col]=e;t.col=t.col||{},t.col.start=t.col.start||0,t.col.end=t.col.end||r[0].length,t.col.step=t.col.step||1,o=c.arange(t.col.start,n.min(r.length,t.col.end),t.col.step);var a=t.row;return o.forEach((function(n,t){r[a][n]=e[t]})),r}if(f(t.col)){t.row=t.row||{},t.row.start=t.row.start||0,t.row.end=t.row.end||r.length,t.row.step=t.row.step||1,u=c.arange(t.row.start,n.min(r[0].length,t.row.end),t.row.step);var i=t.col;return u.forEach((function(n,t){r[n][i]=e[t]})),r}return void 0===e[0].length&&(e=[e]),t.row.start=t.row.start||0,t.row.end=t.row.end||r.length,t.row.step=t.row.step||1,t.col.start=t.col.start||0,t.col.end=t.col.end||r[0].length,t.col.step=t.col.step||1,u=c.arange(t.row.start,n.min(r.length,t.row.end),t.row.step),o=c.arange(t.col.start,n.min(r[0].length,t.col.end),t.col.step),u.forEach((function(n,t){o.forEach((function(o,u){r[n][o]=e[t][u]}))})),r},c.diagonal=function(n){var r=c.zeros(n.length,n.length);return n.forEach((function(n,t){r[t][t]=n})),r},c.copy=function(n){return n.map((function(n){return f(n)?n:n.map((function(n){return n}))}))};var d=c.prototype;return d.length=0,d.push=Array.prototype.push,d.sort=Array.prototype.sort,d.splice=Array.prototype.splice,d.slice=Array.prototype.slice,d.toArray=function(){return this.length>1?e.call(this):e.call(this)[0]},d.map=function(n,r){return c(c.map(this,n,r))},d.cumreduce=function(n,r){return c(c.cumreduce(this,n,r))},d.alter=function(n){return c.alter(this,n),this},function(n){for(var r=0;r<n.length;r++)!function(n){d[n]=function(r){var t,e=this;return r?(setTimeout((function(){r.call(e,d[n].call(e))})),this):(t=c[n](this),a(t)?c(t):t)}}(n[r])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){d[n]=function(r,t){var e=this;return t?(setTimeout((function(){t.call(e,d[n].call(e,r))})),this):c(c[n](this,r))}}(n[r])}("row col".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){d[n]=function(){return c(c[n].apply(null,arguments))}}(n[r])}("create zeros ones rand identity".split(" ")),c}(Math);return function(n,r){var t=n.utils.isFunction;function e(n,r){return n-r}function o(n,t,e){return r.max(t,r.min(n,e))}n.sum=function(n){for(var r=0,t=n.length;--t>=0;)r+=n[t];return r},n.sumsqrd=function(n){for(var r=0,t=n.length;--t>=0;)r+=n[t]*n[t];return r},n.sumsqerr=function(r){for(var t,e=n.mean(r),o=0,u=r.length;--u>=0;)o+=(t=r[u]-e)*t;return o},n.sumrow=function(n){for(var r=0,t=n.length;--t>=0;)r+=n[t];return r},n.product=function(n){for(var r=1,t=n.length;--t>=0;)r*=n[t];return r},n.min=function(n){for(var r=n[0],t=0;++t<n.length;)n[t]<r&&(r=n[t]);return r},n.max=function(n){for(var r=n[0],t=0;++t<n.length;)n[t]>r&&(r=n[t]);return r},n.unique=function(n){for(var r={},t=[],e=0;e<n.length;e++)r[n[e]]||(r[n[e]]=!0,t.push(n[e]));return t},n.mean=function(r){return n.sum(r)/r.length},n.meansqerr=function(r){return n.sumsqerr(r)/r.length},n.geomean=function(t){return r.pow(n.product(t),1/t.length)},n.median=function(n){var r=n.length,t=n.slice().sort(e);return 1&r?t[r/2|0]:(t[r/2-1]+t[r/2])/2},n.cumsum=function(r){return n.cumreduce(r,(function(n,r){return n+r}))},n.cumprod=function(r){return n.cumreduce(r,(function(n,r){return n*r}))},n.diff=function(n){var r,t=[],e=n.length;for(r=1;r<e;r++)t.push(n[r]-n[r-1]);return t},n.rank=function(n){for(var r,t=n.length,o=n.slice().sort(e),u=new Array(t),a=0;a<t;a++){var i=o.indexOf(n[a]),f=o.lastIndexOf(n[a]);r=i===f?i:(i+f)/2,u[a]=r+1}return u},n.mode=function(n){var r,t=n.length,o=n.slice().sort(e),u=1,a=0,i=0,f=[];for(r=0;r<t;r++)o[r]===o[r+1]?u++:(u>a?(f=[o[r]],a=u,i=0):u===a&&(f.push(o[r]),i++),u=1);return 0===i?f[0]:f},n.range=function(r){return n.max(r)-n.min(r)},n.variance=function(r,t){return n.sumsqerr(r)/(r.length-(t?1:0))},n.pooledvariance=function(r){return r.reduce((function(r,t){return r+n.sumsqerr(t)}),0)/(r.reduce((function(n,r){return n+r.length}),0)-r.length)},n.deviation=function(r){for(var t=n.mean(r),e=r.length,o=new Array(e),u=0;u<e;u++)o[u]=r[u]-t;return o},n.stdev=function(t,e){return r.sqrt(n.variance(t,e))},n.pooledstdev=function(t){return r.sqrt(n.pooledvariance(t))},n.meandev=function(t){for(var e=n.mean(t),o=[],u=t.length-1;u>=0;u--)o.push(r.abs(t[u]-e));return n.mean(o)},n.meddev=function(t){for(var e=n.median(t),o=[],u=t.length-1;u>=0;u--)o.push(r.abs(t[u]-e));return n.median(o)},n.coeffvar=function(r){return n.stdev(r)/n.mean(r)},n.quartiles=function(n){var t=n.length,o=n.slice().sort(e);return[o[r.round(t/4)-1],o[r.round(t/2)-1],o[r.round(3*t/4)-1]]},n.quantiles=function(n,t,u,a){var i,f,c,l,s,p=n.slice().sort(e),d=[t.length],h=n.length;for("undefined"===typeof u&&(u=3/8),"undefined"===typeof a&&(a=3/8),i=0;i<t.length;i++)c=h*(f=t[i])+(u+f*(1-u-a)),l=r.floor(o(c,1,h-1)),s=o(c-l,0,1),d[i]=(1-s)*p[l-1]+s*p[l];return d},n.percentile=function(n,r,t){var o=n.slice().sort(e),u=r*(o.length+(t?1:-1))+(t?0:1),a=parseInt(u),i=u-a;return a+1<o.length?o[a-1]+i*(o[a]-o[a-1]):o[a-1]},n.percentileOfScore=function(n,r,t){var e,o,u=0,a=n.length,i=!1;for("strict"===t&&(i=!0),o=0;o<a;o++)e=n[o],(i&&e<r||!i&&e<=r)&&u++;return u/a},n.histogram=function(t,e){e=e||4;var o,u=n.min(t),a=(n.max(t)-u)/e,i=t.length,f=[];for(o=0;o<e;o++)f[o]=0;for(o=0;o<i;o++)f[r.min(r.floor((t[o]-u)/a),e-1)]+=1;return f},n.covariance=function(r,t){var e,o=n.mean(r),u=n.mean(t),a=r.length,i=new Array(a);for(e=0;e<a;e++)i[e]=(r[e]-o)*(t[e]-u);return n.sum(i)/(a-1)},n.corrcoeff=function(r,t){return n.covariance(r,t)/n.stdev(r,1)/n.stdev(t,1)},n.spearmancoeff=function(r,t){return r=n.rank(r),t=n.rank(t),n.corrcoeff(r,t)},n.stanMoment=function(t,e){for(var o=n.mean(t),u=n.stdev(t),a=t.length,i=0,f=0;f<a;f++)i+=r.pow((t[f]-o)/u,e);return i/t.length},n.skewness=function(r){return n.stanMoment(r,3)},n.kurtosis=function(r){return n.stanMoment(r,4)-3};var u=n.prototype;!function(r){for(var e=0;e<r.length;e++)!function(r){u[r]=function(e,o){var a=[],i=0,f=this;if(t(e)&&(o=e,e=!1),o)return setTimeout((function(){o.call(f,u[r].call(f,e))})),this;if(this.length>1){for(f=!0===e?this:this.transpose();i<f.length;i++)a[i]=n[r](f[i]);return a}return n[r](this[0],e)}}(r[e])}("cumsum cumprod".split(" ")),function(r){for(var e=0;e<r.length;e++)!function(r){u[r]=function(e,o){var a=[],i=0,f=this;if(t(e)&&(o=e,e=!1),o)return setTimeout((function(){o.call(f,u[r].call(f,e))})),this;if(this.length>1){for("sumrow"!==r&&(f=!0===e?this:this.transpose());i<f.length;i++)a[i]=n[r](f[i]);return!0===e?n[r](n.utils.toVector(a)):a}return n[r](this[0],e)}}(r[e])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(r){for(var e=0;e<r.length;e++)!function(r){u[r]=function(){var e,o=[],a=0,i=this,f=Array.prototype.slice.call(arguments);if(t(f[f.length-1])){e=f[f.length-1];var c=f.slice(0,f.length-1);return setTimeout((function(){e.call(i,u[r].apply(i,c))})),this}e=void 0;var l=function(t){return n[r].apply(i,[t].concat(f))};if(this.length>1){for(i=i.transpose();a<i.length;a++)o[a]=l(i[a]);return o}return l(this[0])}}(r[e])}("quantiles percentileOfScore".split(" "))}(n,Math),function(n,r){n.gammaln=function(n){var t,e,o,u=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015;for(o=(e=t=n)+5.5,o-=(t+.5)*r.log(o);u<6;u++)i+=a[u]/++e;return r.log(2.5066282746310007*i/t)-o},n.loggam=function(n){var t,e,o,u,a,i,f,c=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(t=n,f=0,1==n||2==n)return 0;for(n<=7&&(t=n+(f=r.floor(7-n))),e=1/(t*t),o=2*r.PI,a=c[9],i=8;i>=0;i--)a*=e,a+=c[i];if(u=a/t+.5*r.log(o)+(t-.5)*r.log(t)-t,n<=7)for(i=1;i<=f;i++)u-=r.log(t-1),t-=1;return u},n.gammafn=function(n){var t,e,o,u,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,c=0,l=0,s=0,p=n;if(p<=0){if(!(u=p%1+36e-17))return 1/0;f=(1&p?-1:1)*r.PI/r.sin(r.PI*u),p=1-p}for(o=p,e=p<1?p++:(p-=c=(0|p)-1)-1,t=0;t<8;++t)s=(s+a[t])*e,l=l*e+i[t];if(u=s/l+1,o<p)u/=o;else if(o>p)for(t=0;t<c;++t)u*=p,p++;return f&&(u=f/u),u},n.gammap=function(r,t){return n.lowRegGamma(r,t)*n.gammafn(r)},n.lowRegGamma=function(t,e){var o,u=n.gammaln(t),a=t,i=1/t,f=i,c=e+1-t,l=1/1e-30,s=1/c,p=s,d=1,h=-~(8.5*r.log(t>=1?t:1/t)+.4*t+17);if(e<0||t<=0)return NaN;if(e<t+1){for(;d<=h;d++)i+=f*=e/++a;return i*r.exp(-e+t*r.log(e)-u)}for(;d<=h;d++)p*=(s=1/(s=(o=-d*(d-t))*s+(c+=2)))*(l=c+o/l);return 1-p*r.exp(-e+t*r.log(e)-u)},n.factorialln=function(r){return r<0?NaN:n.gammaln(r+1)},n.factorial=function(r){return r<0?NaN:n.gammafn(r+1)},n.combination=function(t,e){return t>170||e>170?r.exp(n.combinationln(t,e)):n.factorial(t)/n.factorial(e)/n.factorial(t-e)},n.combinationln=function(r,t){return n.factorialln(r)-n.factorialln(t)-n.factorialln(r-t)},n.permutation=function(r,t){return n.factorial(r)/n.factorial(r-t)},n.betafn=function(t,e){if(!(t<=0||e<=0))return t+e>170?r.exp(n.betaln(t,e)):n.gammafn(t)*n.gammafn(e)/n.gammafn(t+e)},n.betaln=function(r,t){return n.gammaln(r)+n.gammaln(t)-n.gammaln(r+t)},n.betacf=function(n,t,e){var o,u,a,i,f=1,c=t+e,l=t+1,s=t-1,p=1,d=1-c*n/l;for(r.abs(d)<1e-30&&(d=1e-30),i=d=1/d;f<=100&&(d=1+(u=f*(e-f)*n/((s+(o=2*f))*(t+o)))*d,r.abs(d)<1e-30&&(d=1e-30),p=1+u/p,r.abs(p)<1e-30&&(p=1e-30),i*=(d=1/d)*p,d=1+(u=-(t+f)*(c+f)*n/((t+o)*(l+o)))*d,r.abs(d)<1e-30&&(d=1e-30),p=1+u/p,r.abs(p)<1e-30&&(p=1e-30),i*=a=(d=1/d)*p,!(r.abs(a-1)<3e-7));f++);return i},n.gammapinv=function(t,e){var o,u,a,i,f,c,l=0,s=e-1,p=n.gammaln(e);if(t>=1)return r.max(100,e+100*r.sqrt(e));if(t<=0)return 0;for(e>1?(f=r.log(s),c=r.exp(s*(f-1)-p),i=t<.5?t:1-t,o=(2.30753+.27061*(u=r.sqrt(-2*r.log(i))))/(1+u*(.99229+.04481*u))-u,t<.5&&(o=-o),o=r.max(.001,e*r.pow(1-1/(9*e)-o/(3*r.sqrt(e)),3))):o=t<(u=1-e*(.253+.12*e))?r.pow(t/u,1/e):1-r.log(1-(t-u)/(1-u));l<12;l++){if(o<=0)return 0;if((o-=u=(a=(n.lowRegGamma(e,o)-t)/(u=e>1?c*r.exp(-(o-s)+s*(r.log(o)-f)):r.exp(-o+s*r.log(o)-p)))/(1-.5*r.min(1,a*((e-1)/o-1))))<=0&&(o=.5*(o+u)),r.abs(u)<1e-8*o)break}return o},n.erf=function(n){var t,e,o,u,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],i=a.length-1,f=!1,c=0,l=0;for(n<0&&(n=-n,f=!0),e=4*(t=2/(2+n))-2;i>0;i--)o=c,c=e*c-l+a[i],l=o;return u=t*r.exp(-n*n+.5*(a[0]+e*c)-l),f?u-1:1-u},n.erfc=function(r){return 1-n.erf(r)},n.erfcinv=function(t){var e,o,u,a,i=0;if(t>=2)return-100;if(t<=0)return 100;for(a=t<1?t:2-t,e=-.70711*((2.30753+.27061*(u=r.sqrt(-2*r.log(a/2))))/(1+u*(.99229+.04481*u))-u);i<2;i++)e+=(o=n.erfc(e)-a)/(1.1283791670955126*r.exp(-e*e)-e*o);return t<1?e:-e},n.ibetainv=function(t,e,o){var u,a,i,f,c,l,s,p,d,h,m=e-1,v=o-1,g=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&o>=1?(i=t<.5?t:1-t,l=(2.30753+.27061*(f=r.sqrt(-2*r.log(i))))/(1+f*(.99229+.04481*f))-f,t<.5&&(l=-l),s=(l*l-3)/6,p=2/(1/(2*e-1)+1/(2*o-1)),d=l*r.sqrt(s+p)/p-(1/(2*o-1)-1/(2*e-1))*(s+5/6-2/(3*p)),l=e/(e+o*r.exp(2*d))):(u=r.log(e/(e+o)),a=r.log(o/(e+o)),l=t<(f=r.exp(e*u)/e)/(d=f+(c=r.exp(o*a)/o))?r.pow(e*d*t,1/e):1-r.pow(o*d*(1-t),1/o)),h=-n.gammaln(e)-n.gammaln(o)+n.gammaln(e+o);g<10;g++){if(0===l||1===l)return l;if((l-=f=(c=(n.ibeta(l,e,o)-t)/(f=r.exp(m*r.log(l)+v*r.log(1-l)+h)))/(1-.5*r.min(1,c*(m/l-v/(1-l)))))<=0&&(l=.5*(l+f)),l>=1&&(l=.5*(l+f+1)),r.abs(f)<1e-8*l&&g>0)break}return l},n.ibeta=function(t,e,o){var u=0===t||1===t?0:r.exp(n.gammaln(e+o)-n.gammaln(e)-n.gammaln(o)+e*r.log(t)+o*r.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+o+2)?u*n.betacf(t,e,o)/e:1-u*n.betacf(1-t,o,e)/o)},n.randn=function(t,e){var o,u,a,i,f;if(e||(e=t),t)return n.create(t,e,(function(){return n.randn()}));do{o=n._random_fn(),u=1.7156*(n._random_fn()-.5),f=(a=o-.449871)*a+(i=r.abs(u)+.386595)*(.196*i-.25472*a)}while(f>.27597&&(f>.27846||u*u>-4*r.log(o)*o*o));return u/o},n.randg=function(t,e,o){var u,a,i,f,c,l,s=t;if(o||(o=e),t||(t=1),e)return(l=n.zeros(e,o)).alter((function(){return n.randg(t)})),l;t<1&&(t+=1),u=t-1/3,a=1/r.sqrt(9*u);do{do{f=1+a*(c=n.randn())}while(f<=0);f*=f*f,i=n._random_fn()}while(i>1-.331*r.pow(c,4)&&r.log(i)>.5*c*c+u*(1-f+r.log(f)));if(t==s)return u*f;do{i=n._random_fn()}while(0===i);return r.pow(i,1/s)*u*f},function(r){for(var t=0;t<r.length;t++)!function(r){n.fn[r]=function(){return n(n.map(this,(function(t){return n[r](t)})))}}(r[t])}("gammaln gammafn factorial factorialln".split(" ")),function(r){for(var t=0;t<r.length;t++)!function(r){n.fn[r]=function(){return n(n[r].apply(null,arguments))}}(r[t])}("randn".split(" "))}(n,Math),function(n,r){function t(n,t,e,o){for(var u,a=0,i=1,f=1,c=1,l=0,s=0;r.abs((f-s)/f)>o;)s=f,i=c+(u=-(t+l)*(t+e+l)*n/(t+2*l)/(t+2*l+1))*i,f=(a=f+u*a)+(u=(l+=1)*(e-l)*n/(t+2*l-1)/(t+2*l))*f,a/=c=i+u*c,i/=c,f/=c,c=1;return f/t}function e(t,e,o){var u=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],a=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],i=.5*t;if(i>=8)return 1;var f,c=2*n.normal.cdf(i,0,1,1,0)-1;c=c>=r.exp(-50/o)?r.pow(c,o):0;for(var l=i,s=(8-i)/(f=t>3?2:3),p=l+s,d=0,h=o-1,m=1;m<=f;m++){for(var v=0,g=.5*(p+l),y=.5*(p-l),b=1;b<=12;b++){var w,x=g+y*(6<b?u[(w=12-b+1)-1]:-u[(w=b)-1]),_=x*x;if(_>60)break;var j=2*n.normal.cdf(x,0,1,1,0)*.5-2*n.normal.cdf(x,t,1,1,0)*.5;j>=r.exp(-30/h)&&(v+=j=a[w-1]*r.exp(-.5*_)*r.pow(j,h))}d+=v*=2*y*o/r.sqrt(2*r.PI),l=p,p+=s}return(c+=d)<=r.exp(-30/e)?0:(c=r.pow(c,e))>=1?1:c}!function(r){for(var t=0;t<r.length;t++)!function(r){n[r]=function(n,r,t){return this instanceof arguments.callee?(this._a=n,this._b=r,this._c=t,this):new arguments.callee(n,r,t)},n.fn[r]=function(t,e,o){var u=n[r](t,e,o);return u.data=this,u},n[r].prototype.sample=function(t){var e=this._a,o=this._b,u=this._c;return t?n.alter(t,(function(){return n[r].sample(e,o,u)})):n[r].sample(e,o,u)},function(t){for(var e=0;e<t.length;e++)!function(t){n[r].prototype[t]=function(e){var o=this._a,u=this._b,a=this._c;return e||0===e||(e=this.data),"number"!==typeof e?n.fn.map.call(e,(function(e){return n[r][t](e,o,u,a)})):n[r][t](e,o,u,a)}}(t[e])}("pdf cdf inv".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){n[r].prototype[t]=function(){return n[r][t](this._a,this._b,this._c)}}(t[e])}("mean median mode variance".split(" "))}(r[t])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),n.extend(n.beta,{pdf:function(t,e,o){return t>1||t<0?0:1==e&&1==o?1:e<512&&o<512?r.pow(t,e-1)*r.pow(1-t,o-1)/n.betafn(e,o):r.exp((e-1)*r.log(t)+(o-1)*r.log(1-t)-n.betaln(e,o))},cdf:function(r,t,e){return r>1||r<0?1*(r>1):n.ibeta(r,t,e)},inv:function(r,t,e){return n.ibetainv(r,t,e)},mean:function(n,r){return n/(n+r)},median:function(r,t){return n.ibetainv(.5,r,t)},mode:function(n,r){return(n-1)/(n+r-2)},sample:function(r,t){var e=n.randg(r);return e/(e+n.randg(t))},variance:function(n,t){return n*t/(r.pow(n+t,2)*(n+t+1))}}),n.extend(n.centralF,{pdf:function(t,e,o){var u;return t<0?0:e<=2?0===t&&e<2?1/0:0===t&&2===e?1:1/n.betafn(e/2,o/2)*r.pow(e/o,e/2)*r.pow(t,e/2-1)*r.pow(1+e/o*t,-(e+o)/2):(u=e*t/(o+t*e),e*(o/(o+t*e))/2*n.binomial.pdf((e-2)/2,(e+o-2)/2,u))},cdf:function(r,t,e){return r<0?0:n.ibeta(t*r/(t*r+e),t/2,e/2)},inv:function(r,t,e){return e/(t*(1/n.ibetainv(r,t/2,e/2)-1))},mean:function(n,r){return r>2?r/(r-2):void 0},mode:function(n,r){return n>2?r*(n-2)/(n*(r+2)):void 0},sample:function(r,t){return 2*n.randg(r/2)/r/(2*n.randg(t/2)/t)},variance:function(n,r){if(!(r<=4))return 2*r*r*(n+r-2)/(n*(r-2)*(r-2)*(r-4))}}),n.extend(n.cauchy,{pdf:function(n,t,e){return e<0?0:e/(r.pow(n-t,2)+r.pow(e,2))/r.PI},cdf:function(n,t,e){return r.atan((n-t)/e)/r.PI+.5},inv:function(n,t,e){return t+e*r.tan(r.PI*(n-.5))},median:function(n){return n},mode:function(n){return n},sample:function(t,e){return n.randn()*r.sqrt(1/(2*n.randg(.5)))*e+t}}),n.extend(n.chisquare,{pdf:function(t,e){return t<0?0:0===t&&2===e?.5:r.exp((e/2-1)*r.log(t)-t/2-e/2*r.log(2)-n.gammaln(e/2))},cdf:function(r,t){return r<0?0:n.lowRegGamma(t/2,r/2)},inv:function(r,t){return 2*n.gammapinv(r,.5*t)},mean:function(n){return n},median:function(n){return n*r.pow(1-2/(9*n),3)},mode:function(n){return n-2>0?n-2:0},sample:function(r){return 2*n.randg(r/2)},variance:function(n){return 2*n}}),n.extend(n.exponential,{pdf:function(n,t){return n<0?0:t*r.exp(-t*n)},cdf:function(n,t){return n<0?0:1-r.exp(-t*n)},inv:function(n,t){return-r.log(1-n)/t},mean:function(n){return 1/n},median:function(n){return 1/n*r.log(2)},mode:function(){return 0},sample:function(t){return-1/t*r.log(n._random_fn())},variance:function(n){return r.pow(n,-2)}}),n.extend(n.gamma,{pdf:function(t,e,o){return t<0?0:0===t&&1===e?1/o:r.exp((e-1)*r.log(t)-t/o-n.gammaln(e)-e*r.log(o))},cdf:function(r,t,e){return r<0?0:n.lowRegGamma(t,r/e)},inv:function(r,t,e){return n.gammapinv(r,t)*e},mean:function(n,r){return n*r},mode:function(n,r){if(n>1)return(n-1)*r},sample:function(r,t){return n.randg(r)*t},variance:function(n,r){return n*r*r}}),n.extend(n.invgamma,{pdf:function(t,e,o){return t<=0?0:r.exp(-(e+1)*r.log(t)-o/t-n.gammaln(e)+e*r.log(o))},cdf:function(r,t,e){return r<=0?0:1-n.lowRegGamma(t,e/r)},inv:function(r,t,e){return e/n.gammapinv(1-r,t)},mean:function(n,r){return n>1?r/(n-1):void 0},mode:function(n,r){return r/(n+1)},sample:function(r,t){return t/n.randg(r)},variance:function(n,r){if(!(n<=2))return r*r/((n-1)*(n-1)*(n-2))}}),n.extend(n.kumaraswamy,{pdf:function(n,t,e){return 0===n&&1===t?e:1===n&&1===e?t:r.exp(r.log(t)+r.log(e)+(t-1)*r.log(n)+(e-1)*r.log(1-r.pow(n,t)))},cdf:function(n,t,e){return n<0?0:n>1?1:1-r.pow(1-r.pow(n,t),e)},inv:function(n,t,e){return r.pow(1-r.pow(1-n,1/e),1/t)},mean:function(r,t){return t*n.gammafn(1+1/r)*n.gammafn(t)/n.gammafn(1+1/r+t)},median:function(n,t){return r.pow(1-r.pow(2,-1/t),1/n)},mode:function(n,t){if(n>=1&&t>=1&&1!==n&&1!==t)return r.pow((n-1)/(n*t-1),1/n)},variance:function(){throw new Error("variance not yet implemented")}}),n.extend(n.lognormal,{pdf:function(n,t,e){return n<=0?0:r.exp(-r.log(n)-.5*r.log(2*r.PI)-r.log(e)-r.pow(r.log(n)-t,2)/(2*e*e))},cdf:function(t,e,o){return t<0?0:.5+.5*n.erf((r.log(t)-e)/r.sqrt(2*o*o))},inv:function(t,e,o){return r.exp(-1.4142135623730951*o*n.erfcinv(2*t)+e)},mean:function(n,t){return r.exp(n+t*t/2)},median:function(n){return r.exp(n)},mode:function(n,t){return r.exp(n-t*t)},sample:function(t,e){return r.exp(n.randn()*e+t)},variance:function(n,t){return(r.exp(t*t)-1)*r.exp(2*n+t*t)}}),n.extend(n.noncentralt,{pdf:function(t,e,o){return r.abs(o)<1e-14?n.studentt.pdf(t,e):r.abs(t)<1e-14?r.exp(n.gammaln((e+1)/2)-o*o/2-.5*r.log(r.PI*e)-n.gammaln(e/2)):e/t*(n.noncentralt.cdf(t*r.sqrt(1+2/e),e+2,o)-n.noncentralt.cdf(t,e,o))},cdf:function(t,e,o){if(r.abs(o)<1e-14)return n.studentt.cdf(t,e);var u=!1;t<0&&(u=!0,o=-o);for(var a=n.normal.cdf(-o,0,1),i=1e-14+1,f=i,c=t*t/(t*t+e),l=0,s=r.exp(-o*o/2),p=r.exp(-o*o/2-.5*r.log(2)-n.gammaln(1.5))*o;l<200||f>1e-14||i>1e-14;)f=i,l>0&&(s*=o*o/(2*l),p*=o*o/(2*(l+.5))),a+=.5*(i=s*n.beta.cdf(c,l+.5,e/2)+p*n.beta.cdf(c,l+1,e/2)),l++;return u?1-a:a}}),n.extend(n.normal,{pdf:function(n,t,e){return r.exp(-.5*r.log(2*r.PI)-r.log(e)-r.pow(n-t,2)/(2*e*e))},cdf:function(t,e,o){return.5*(1+n.erf((t-e)/r.sqrt(2*o*o)))},inv:function(r,t,e){return-1.4142135623730951*e*n.erfcinv(2*r)+t},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},sample:function(r,t){return n.randn()*t+r},variance:function(n,r){return r*r}}),n.extend(n.pareto,{pdf:function(n,t,e){return n<t?0:e*r.pow(t,e)/r.pow(n,e+1)},cdf:function(n,t,e){return n<t?0:1-r.pow(t/n,e)},inv:function(n,t,e){return t/r.pow(1-n,1/e)},mean:function(n,t){if(!(t<=1))return t*r.pow(n,t)/(t-1)},median:function(n,t){return n*(t*r.SQRT2)},mode:function(n){return n},variance:function(n,t){if(!(t<=2))return n*n*t/(r.pow(t-1,2)*(t-2))}}),n.extend(n.studentt,{pdf:function(t,e){return e=e>1e100?1e100:e,1/(r.sqrt(e)*n.betafn(.5,e/2))*r.pow(1+t*t/e,-(e+1)/2)},cdf:function(t,e){var o=e/2;return n.ibeta((t+r.sqrt(t*t+e))/(2*r.sqrt(t*t+e)),o,o)},inv:function(t,e){var o=n.ibetainv(2*r.min(t,1-t),.5*e,.5);return o=r.sqrt(e*(1-o)/o),t>.5?o:-o},mean:function(n){return n>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(t){return n.randn()*r.sqrt(t/(2*n.randg(t/2)))},variance:function(n){return n>2?n/(n-2):n>1?1/0:void 0}}),n.extend(n.weibull,{pdf:function(n,t,e){return n<0||t<0||e<0?0:e/t*r.pow(n/t,e-1)*r.exp(-r.pow(n/t,e))},cdf:function(n,t,e){return n<0?0:1-r.exp(-r.pow(n/t,e))},inv:function(n,t,e){return t*r.pow(-r.log(1-n),1/e)},mean:function(r,t){return r*n.gammafn(1+1/t)},median:function(n,t){return n*r.pow(r.log(2),1/t)},mode:function(n,t){return t<=1?0:n*r.pow((t-1)/t,1/t)},sample:function(t,e){return t*r.pow(-r.log(n._random_fn()),1/e)},variance:function(t,e){return t*t*n.gammafn(1+2/e)-r.pow(n.weibull.mean(t,e),2)}}),n.extend(n.uniform,{pdf:function(n,r,t){return n<r||n>t?0:1/(t-r)},cdf:function(n,r,t){return n<r?0:n<t?(n-r)/(t-r):1},inv:function(n,r,t){return r+n*(t-r)},mean:function(n,r){return.5*(n+r)},median:function(r,t){return n.mean(r,t)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,t){return r/2+t/2+(t/2-r/2)*(2*n._random_fn()-1)},variance:function(n,t){return r.pow(t-n,2)/12}}),n.extend(n.binomial,{pdf:function(t,e,o){return 0===o||1===o?e*o===t?1:0:n.combination(e,t)*r.pow(o,t)*r.pow(1-o,e-t)},cdf:function(e,o,u){var a;if(e<0)return 0;if(e>=o)return 1;if(u<0||u>1||o<=0)return NaN;var i=u,f=(e=r.floor(e))+1,c=o-e,l=f+c,s=r.exp(n.gammaln(l)-n.gammaln(c)-n.gammaln(f)+f*r.log(i)+c*r.log(1-i));return a=i<(f+1)/(l+2)?s*t(i,f,c,1e-10):1-s*t(1-i,c,f,1e-10),r.round(1e10*(1-a))/1e10}}),n.extend(n.negbin,{pdf:function(t,e,o){return t===t>>>0&&(t<0?0:n.combination(t+e-1,e-1)*r.pow(1-o,t)*r.pow(o,e))},cdf:function(r,t,e){var o=0,u=0;if(r<0)return 0;for(;u<=r;u++)o+=n.negbin.pdf(u,t,e);return o}}),n.extend(n.hypgeom,{pdf:function(t,e,o,u){if(t!==t|0)return!1;if(t<0||t<o-(e-u))return 0;if(t>u||t>o)return 0;if(2*o>e)return 2*u>e?n.hypgeom.pdf(e-o-u+t,e,e-o,e-u):n.hypgeom.pdf(u-t,e,e-o,u);if(2*u>e)return n.hypgeom.pdf(o-t,e,o,e-u);if(o<u)return n.hypgeom.pdf(t,e,u,o);for(var a=1,i=0,f=0;f<t;f++){for(;a>1&&i<u;)a*=1-o/(e-i),i++;a*=(u-f)*(o-f)/((f+1)*(e-o-u+f+1))}for(;i<u;i++)a*=1-o/(e-i);return r.min(1,r.max(0,a))},cdf:function(t,e,o,u){if(t<0||t<o-(e-u))return 0;if(t>=u||t>=o)return 1;if(2*o>e)return 2*u>e?n.hypgeom.cdf(e-o-u+t,e,e-o,e-u):1-n.hypgeom.cdf(u-t-1,e,e-o,u);if(2*u>e)return 1-n.hypgeom.cdf(o-t-1,e,o,e-u);if(o<u)return n.hypgeom.cdf(t,e,u,o);for(var a=1,i=1,f=0,c=0;c<t;c++){for(;a>1&&f<u;){var l=1-o/(e-f);i*=l,a*=l,f++}a+=i*=(u-c)*(o-c)/((c+1)*(e-o-u+c+1))}for(;f<u;f++)a*=1-o/(e-f);return r.min(1,r.max(0,a))}}),n.extend(n.poisson,{pdf:function(t,e){return e<0||t%1!==0||t<0?0:r.pow(e,t)*r.exp(-e)/n.factorial(t)},cdf:function(r,t){var e=[],o=0;if(r<0)return 0;for(;o<=r;o++)e.push(n.poisson.pdf(o,t));return n.sum(e)},mean:function(n){return n},variance:function(n){return n},sampleSmall:function(t){var e=1,o=0,u=r.exp(-t);do{o++,e*=n._random_fn()}while(e>u);return o-1},sampleLarge:function(t){var e,o,u,a,i,f,c,l,s,p,d=t;for(a=r.sqrt(d),i=r.log(d),f=.02483*(c=.931+2.53*a)-.059,l=1.1239+1.1328/(c-3.4),s=.9277-3.6224/(c-2);;){if(o=r.random()-.5,u=r.random(),p=.5-r.abs(o),e=r.floor((2*f/p+c)*o+d+.43),p>=.07&&u<=s)return e;if(!(e<0||p<.013&&u>p)&&r.log(u)+r.log(l)-r.log(f/(p*p)+c)<=e*i-d-n.loggam(e+1))return e}},sample:function(n){return n<10?this.sampleSmall(n):this.sampleLarge(n)}}),n.extend(n.triangular,{pdf:function(n,r,t,e){return t<=r||e<r||e>t?NaN:n<r||n>t?0:n<e?2*(n-r)/((t-r)*(e-r)):n===e?2/(t-r):2*(t-n)/((t-r)*(t-e))},cdf:function(n,t,e,o){return e<=t||o<t||o>e?NaN:n<=t?0:n>=e?1:n<=o?r.pow(n-t,2)/((e-t)*(o-t)):1-r.pow(e-n,2)/((e-t)*(e-o))},inv:function(n,t,e,o){return e<=t||o<t||o>e?NaN:n<=(o-t)/(e-t)?t+(e-t)*r.sqrt(n*((o-t)/(e-t))):t+(e-t)*(1-r.sqrt((1-n)*(1-(o-t)/(e-t))))},mean:function(n,r,t){return(n+r+t)/3},median:function(n,t,e){return e<=(n+t)/2?t-r.sqrt((t-n)*(t-e))/r.sqrt(2):e>(n+t)/2?n+r.sqrt((t-n)*(e-n))/r.sqrt(2):void 0},mode:function(n,r,t){return t},sample:function(t,e,o){var u=n._random_fn();return u<(o-t)/(e-t)?t+r.sqrt(u*(e-t)*(o-t)):e-r.sqrt((1-u)*(e-t)*(e-o))},variance:function(n,r,t){return(n*n+r*r+t*t-n*r-n*t-r*t)/18}}),n.extend(n.arcsine,{pdf:function(n,t,e){return e<=t?NaN:n<=t||n>=e?0:2/r.PI*r.pow(r.pow(e-t,2)-r.pow(2*n-t-e,2),-.5)},cdf:function(n,t,e){return n<t?0:n<e?2/r.PI*r.asin(r.sqrt((n-t)/(e-t))):1},inv:function(n,t,e){return t+(.5-.5*r.cos(r.PI*n))*(e-t)},mean:function(n,r){return r<=n?NaN:(n+r)/2},median:function(n,r){return r<=n?NaN:(n+r)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,e){return(t+e)/2+(e-t)/2*r.sin(2*r.PI*n.uniform.sample(0,1))},variance:function(n,t){return t<=n?NaN:r.pow(t-n,2)/8}}),n.extend(n.laplace,{pdf:function(n,t,e){return e<=0?0:r.exp(-r.abs(n-t)/e)/(2*e)},cdf:function(n,t,e){return e<=0?0:n<t?.5*r.exp((n-t)/e):1-.5*r.exp(-(n-t)/e)},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},variance:function(n,r){return 2*r*r},sample:function(t,e){var o,u=n._random_fn()-.5;return t-e*((o=u)/r.abs(o))*r.log(1-2*r.abs(u))}}),n.extend(n.tukey,{cdf:function(t,o,u){var a=o,i=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],f=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(t<=0)return 0;if(u<2||a<2)return NaN;if(!Number.isFinite(t))return 1;if(u>25e3)return e(t,1,a);var c,l=.5*u,s=l*r.log(u)-u*r.log(2)-n.gammaln(l),p=l-1,d=.25*u;c=u<=100?1:u<=800?.5:u<=5e3?.25:.125,s+=r.log(c);for(var h=0,m=1;m<=50;m++){for(var v=0,g=(2*m-1)*c,y=1;y<=16;y++){var b,w;8<y?(b=y-8-1,w=s+p*r.log(g+i[b]*c)-(i[b]*c+g)*d):(b=y-1,w=s+p*r.log(g-i[b]*c)+(i[b]*c-g)*d),w>=-30&&(v+=e(8<y?t*r.sqrt(.5*(i[b]*c+g)):t*r.sqrt(.5*(-i[b]*c+g)),1,a)*f[b]*r.exp(w))}if(m*c>=1&&v<=1e-14)break;h+=v}if(v>1e-14)throw new Error("tukey.cdf failed to converge");return h>1&&(h=1),h},inv:function(t,e,o){if(o<2||e<2)return NaN;if(t<0||t>1)return NaN;if(0===t)return 0;if(1===t)return 1/0;var u,a=function(n,t,e){var o=.5-.5*n,u=r.sqrt(r.log(1/(o*o))),a=u+((((-453642210148e-16*u-.204231210125)*u-.342242088547)*u-1)*u+.322232421088)/((((.0038560700634*u+.10353775285)*u+.531103462366)*u+.588581570495)*u+.099348462606);e<120&&(a+=(a*a*a+a)/e/4);var i=.8832-.2368*a;return e<120&&(i+=-1.214/e+1.208*a/e),a*(i*r.log(t-1)+1.4142)}(t,e,o),i=n.tukey.cdf(a,e,o)-t;u=i>0?r.max(0,a-1):a+1;for(var f,c=n.tukey.cdf(u,e,o)-t,l=1;l<50;l++)if(f=u-c*(u-a)/(c-i),i=c,a=u,f<0&&(f=0,c=-t),c=n.tukey.cdf(f,e,o)-t,u=f,r.abs(u-a)<1e-4)return f;throw new Error("tukey.inv failed to converge")}})}(n,Math),function(n,r){var t=Array.prototype.push,e=n.utils.isArray;function o(r){return e(r)||r instanceof n}n.extend({add:function(r,t){return o(t)?(o(t[0])||(t=[t]),n.map(r,(function(n,r,e){return n+t[r][e]}))):n.map(r,(function(n){return n+t}))},subtract:function(r,t){return o(t)?(o(t[0])||(t=[t]),n.map(r,(function(n,r,e){return n-t[r][e]||0}))):n.map(r,(function(n){return n-t}))},divide:function(r,t){return o(t)?(o(t[0])||(t=[t]),n.multiply(r,n.inv(t))):n.map(r,(function(n){return n/t}))},multiply:function(r,t){var e,u,a,i,f,c,l,s;if(void 0===r.length&&void 0===t.length)return r*t;if(f=r.length,c=r[0].length,l=n.zeros(f,a=o(t)?t[0].length:c),s=0,o(t)){for(;s<a;s++)for(e=0;e<f;e++){for(i=0,u=0;u<c;u++)i+=r[e][u]*t[u][s];l[e][s]=i}return 1===f&&1===s?l[0][0]:l}return n.map(r,(function(n){return n*t}))},outer:function(r,t){return n.multiply(r.map((function(n){return[n]})),[t])},dot:function(r,t){o(r[0])||(r=[r]),o(t[0])||(t=[t]);for(var e,u,a=1===r[0].length&&1!==r.length?n.transpose(r):r,i=1===t[0].length&&1!==t.length?n.transpose(t):t,f=[],c=0,l=a.length,s=a[0].length;c<l;c++){for(f[c]=[],e=0,u=0;u<s;u++)e+=a[c][u]*i[c][u];f[c]=e}return 1===f.length?f[0]:f},pow:function(t,e){return n.map(t,(function(n){return r.pow(n,e)}))},exp:function(t){return n.map(t,(function(n){return r.exp(n)}))},log:function(t){return n.map(t,(function(n){return r.log(n)}))},abs:function(t){return n.map(t,(function(n){return r.abs(n)}))},norm:function(n,t){var e=0,u=0;for(isNaN(t)&&(t=2),o(n[0])&&(n=n[0]);u<n.length;u++)e+=r.pow(r.abs(n[u]),t);return r.pow(e,1/t)},angle:function(t,e){return r.acos(n.dot(t,e)/(n.norm(t)*n.norm(e)))},aug:function(n,r){var e,o=[];for(e=0;e<n.length;e++)o.push(n[e].slice());for(e=0;e<o.length;e++)t.apply(o[e],r[e]);return o},inv:function(r){for(var t,e=r.length,o=r[0].length,u=n.identity(e,o),a=n.gauss_jordan(r,u),i=[],f=0;f<e;f++)for(i[f]=[],t=o;t<a[0].length;t++)i[f][t-o]=a[f][t];return i},det:function(n){var r,t=n.length,e=2*t,o=new Array(e),u=t-1,a=e-1,i=u-t+1,f=a,c=0,l=0;if(2===t)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(;c<e;c++)o[c]=1;for(c=0;c<t;c++){for(r=0;r<t;r++)o[i<0?i+t:i]*=n[c][r],o[f<t?f+t:f]*=n[c][r],i++,f--;i=--u-t+1,f=--a}for(c=0;c<t;c++)l+=o[c];for(;c<e;c++)l-=o[c];return l},gauss_elimination:function(t,e){var o,u,a,i,f=0,c=0,l=t.length,s=t[0].length,p=1,d=0,h=[];for(o=(t=n.aug(t,e))[0].length,f=0;f<l;f++){for(u=t[f][f],c=f,i=f+1;i<s;i++)u<r.abs(t[i][f])&&(u=t[i][f],c=i);if(c!=f)for(i=0;i<o;i++)a=t[f][i],t[f][i]=t[c][i],t[c][i]=a;for(c=f+1;c<l;c++)for(p=t[c][f]/t[f][f],i=f;i<o;i++)t[c][i]=t[c][i]-p*t[f][i]}for(f=l-1;f>=0;f--){for(d=0,c=f+1;c<=l-1;c++)d+=h[c]*t[f][c];h[f]=(t[f][o-1]-d)/t[f][f]}return h},gauss_jordan:function(t,e){var o,u,a,i=n.aug(t,e),f=i.length,c=i[0].length,l=0;for(u=0;u<f;u++){var s=u;for(a=u+1;a<f;a++)r.abs(i[a][u])>r.abs(i[s][u])&&(s=a);var p=i[u];for(i[u]=i[s],i[s]=p,a=u+1;a<f;a++)for(l=i[a][u]/i[u][u],o=u;o<c;o++)i[a][o]-=i[u][o]*l}for(u=f-1;u>=0;u--){for(l=i[u][u],a=0;a<u;a++)for(o=c-1;o>u-1;o--)i[a][o]-=i[u][o]*i[a][u]/l;for(i[u][u]/=l,o=f;o<c;o++)i[u][o]/=l}return i},triaUpSolve:function(r,t){var e,o=r[0].length,u=n.zeros(1,o)[0],a=!1;return void 0!=t[0].length&&(t=t.map((function(n){return n[0]})),a=!0),n.arange(o-1,-1,-1).forEach((function(a){e=n.arange(a+1,o).map((function(n){return u[n]*r[a][n]})),u[a]=(t[a]-n.sum(e))/r[a][a]})),a?u.map((function(n){return[n]})):u},triaLowSolve:function(r,t){var e,o=r[0].length,u=n.zeros(1,o)[0],a=!1;return void 0!=t[0].length&&(t=t.map((function(n){return n[0]})),a=!0),n.arange(o).forEach((function(o){e=n.arange(o).map((function(n){return r[o][n]*u[n]})),u[o]=(t[o]-n.sum(e))/r[o][o]})),a?u.map((function(n){return[n]})):u},lu:function(r){var t,e=r.length,o=n.identity(e),u=n.zeros(r.length,r[0].length);return n.arange(e).forEach((function(n){u[0][n]=r[0][n]})),n.arange(1,e).forEach((function(a){n.arange(a).forEach((function(e){t=n.arange(e).map((function(n){return o[a][n]*u[n][e]})),o[a][e]=(r[a][e]-n.sum(t))/u[e][e]})),n.arange(a,e).forEach((function(e){t=n.arange(a).map((function(n){return o[a][n]*u[n][e]})),u[a][e]=r[t.length][e]-n.sum(t)}))})),[o,u]},cholesky:function(t){var e,o=t.length,u=n.zeros(t.length,t[0].length);return n.arange(o).forEach((function(a){e=n.arange(a).map((function(n){return r.pow(u[a][n],2)})),u[a][a]=r.sqrt(t[a][a]-n.sum(e)),n.arange(a+1,o).forEach((function(r){e=n.arange(a).map((function(n){return u[a][n]*u[r][n]})),u[r][a]=(t[a][r]-n.sum(e))/u[a][a]}))})),u},gauss_jacobi:function(t,e,o,u){for(var a,i,f,c,l=0,s=0,p=t.length,d=[],h=[],m=[];l<p;l++)for(d[l]=[],h[l]=[],m[l]=[],s=0;s<p;s++)l>s?(d[l][s]=t[l][s],h[l][s]=m[l][s]=0):l<s?(h[l][s]=t[l][s],d[l][s]=m[l][s]=0):(m[l][s]=t[l][s],d[l][s]=h[l][s]=0);for(f=n.multiply(n.multiply(n.inv(m),n.add(d,h)),-1),i=n.multiply(n.inv(m),e),a=o,c=n.add(n.multiply(f,o),i),l=2;r.abs(n.norm(n.subtract(c,a)))>u;)a=c,c=n.add(n.multiply(f,a),i),l++;return c},gauss_seidel:function(t,e,o,u){for(var a,i,f,c,l,s=0,p=t.length,d=[],h=[],m=[];s<p;s++)for(d[s]=[],h[s]=[],m[s]=[],a=0;a<p;a++)s>a?(d[s][a]=t[s][a],h[s][a]=m[s][a]=0):s<a?(h[s][a]=t[s][a],d[s][a]=m[s][a]=0):(m[s][a]=t[s][a],d[s][a]=h[s][a]=0);for(c=n.multiply(n.multiply(n.inv(n.add(m,d)),h),-1),f=n.multiply(n.inv(n.add(m,d)),e),i=o,l=n.add(n.multiply(c,o),f),s=2;r.abs(n.norm(n.subtract(l,i)))>u;)i=l,l=n.add(n.multiply(c,i),f),s+=1;return l},SOR:function(t,e,o,u,a){for(var i,f,c,l,s,p=0,d=t.length,h=[],m=[],v=[];p<d;p++)for(h[p]=[],m[p]=[],v[p]=[],i=0;i<d;i++)p>i?(h[p][i]=t[p][i],m[p][i]=v[p][i]=0):p<i?(m[p][i]=t[p][i],h[p][i]=v[p][i]=0):(v[p][i]=t[p][i],h[p][i]=m[p][i]=0);for(l=n.multiply(n.inv(n.add(v,n.multiply(h,a))),n.subtract(n.multiply(v,1-a),n.multiply(m,a))),c=n.multiply(n.multiply(n.inv(n.add(v,n.multiply(h,a))),e),a),f=o,s=n.add(n.multiply(l,o),c),p=2;r.abs(n.norm(n.subtract(s,f)))>u;)f=s,s=n.add(n.multiply(l,f),c),p++;return s},householder:function(t){for(var e,o,u,a,i=t.length,f=t[0].length,c=0,l=[],s=[];c<i-1;c++){for(e=0,a=c+1;a<f;a++)e+=t[a][c]*t[a][c];for(e=(t[c+1][c]>0?-1:1)*r.sqrt(e),o=r.sqrt((e*e-t[c+1][c]*e)/2),(l=n.zeros(i,1))[c+1][0]=(t[c+1][c]-e)/(2*o),u=c+2;u<i;u++)l[u][0]=t[u][c]/(2*o);s=n.subtract(n.identity(i,f),n.multiply(n.multiply(l,n.transpose(l)),2)),t=n.multiply(s,n.multiply(t,s))}return t},QR:function(){var t=n.sum,e=n.arange;return function(o){var u,a,i,f=o.length,c=o[0].length,l=n.zeros(c,c);for(o=n.copy(o),a=0;a<c;a++){for(l[a][a]=r.sqrt(t(e(f).map((function(n){return o[n][a]*o[n][a]})))),u=0;u<f;u++)o[u][a]=o[u][a]/l[a][a];for(i=a+1;i<c;i++)for(l[a][i]=t(e(f).map((function(n){return o[n][a]*o[n][i]}))),u=0;u<f;u++)o[u][i]=o[u][i]-o[u][a]*l[a][i]}return[o,l]}}(),lstsq:function(r,t){var e=!1;void 0===t[0].length&&(t=t.map((function(n){return[n]})),e=!0);var o=n.QR(r),u=o[0],a=o[1],i=r[0].length,f=n.slice(u,{col:{end:i}}),c=function(r){var t=(r=n.copy(r)).length,e=n.identity(t);return n.arange(t-1,-1,-1).forEach((function(t){n.sliceAssign(e,{row:t},n.divide(n.slice(e,{row:t}),r[t][t])),n.sliceAssign(r,{row:t},n.divide(n.slice(r,{row:t}),r[t][t])),n.arange(t).forEach((function(o){var u=n.multiply(r[o][t],-1),a=n.slice(r,{row:o}),i=n.multiply(n.slice(r,{row:t}),u);n.sliceAssign(r,{row:o},n.add(a,i));var f=n.slice(e,{row:o}),c=n.multiply(n.slice(e,{row:t}),u);n.sliceAssign(e,{row:o},n.add(f,c))}))})),e}(n.slice(a,{row:{end:i}})),l=n.transpose(f);void 0===l[0].length&&(l=[l]);var s=n.multiply(n.multiply(c,l),t);return void 0===s.length&&(s=[[s]]),e?s.map((function(n){return n[0]})):s},jacobi:function(t){for(var e,o,u,a,i,f,c,l=1,s=t.length,p=n.identity(s,s),d=[];1===l;){for(i=t[0][1],u=0,a=1,e=0;e<s;e++)for(o=0;o<s;o++)e!=o&&i<r.abs(t[e][o])&&(i=r.abs(t[e][o]),u=e,a=o);for(f=t[u][u]===t[a][a]?t[u][a]>0?r.PI/4:-r.PI/4:r.atan(2*t[u][a]/(t[u][u]-t[a][a]))/2,(c=n.identity(s,s))[u][u]=r.cos(f),c[u][a]=-r.sin(f),c[a][u]=r.sin(f),c[a][a]=r.cos(f),p=n.multiply(p,c),t=n.multiply(n.multiply(n.inv(c),t),c),l=0,e=1;e<s;e++)for(o=1;o<s;o++)e!=o&&r.abs(t[e][o])>.001&&(l=1)}for(e=0;e<s;e++)d.push(t[e][e]);return[p,d]},rungekutta:function(n,r,t,e,o,u){var a,i,f;if(2===u)for(;e<=t;)o+=((a=r*n(e,o))+(i=r*n(e+r,o+a)))/2,e+=r;if(4===u)for(;e<=t;)o+=((a=r*n(e,o))+2*(i=r*n(e+r/2,o+a/2))+2*(f=r*n(e+r/2,o+i/2))+r*n(e+r,o+f))/6,e+=r;return o},romberg:function(n,t,e,o){for(var u,a,i,f,c,l=0,s=(e-t)/2,p=[],d=[],h=[];l<o/2;){for(c=n(t),i=t,f=0;i<=e;i+=s,f++)p[f]=i;for(u=p.length,i=1;i<u-1;i++)c+=(i%2!==0?4:2)*n(p[i]);c=s/3*(c+n(e)),h[l]=c,s/=2,l++}for(a=h.length,u=1;1!==a;){for(i=0;i<a-1;i++)d[i]=(r.pow(4,u)*h[i+1]-h[i])/(r.pow(4,u)-1);a=d.length,h=d,d=[],u++}return h},richardson:function(n,t,e,o){function u(n,r){for(var t,e=0,o=n.length;e<o;e++)n[e]===r&&(t=e);return t}for(var a,i,f,c,l,s=r.abs(e-n[u(n,e)+1]),p=0,d=[],h=[];o>=s;)a=u(n,e+o),i=u(n,e),d[p]=(t[a]-2*t[i]+t[2*i-a])/(o*o),o/=2,p++;for(c=d.length,f=1;1!=c;){for(l=0;l<c-1;l++)h[l]=(r.pow(4,f)*d[l+1]-d[l])/(r.pow(4,f)-1);c=h.length,d=h,h=[],f++}return d},simpson:function(n,r,t,e){for(var o,u=(t-r)/e,a=n(r),i=[],f=r,c=0,l=1;f<=t;f+=u,c++)i[c]=f;for(o=i.length;l<o-1;l++)a+=(l%2!==0?4:2)*n(i[l]);return u/3*(a+n(t))},hermite:function(n,r,t,e){for(var o,u=n.length,a=0,i=0,f=[],c=[],l=[],s=[];i<u;i++){for(f[i]=1,o=0;o<u;o++)i!=o&&(f[i]*=(e-n[o])/(n[i]-n[o]));for(c[i]=0,o=0;o<u;o++)i!=o&&(c[i]+=1/(n[i]-n[o]));l[i]=(1-2*(e-n[i])*c[i])*(f[i]*f[i]),s[i]=(e-n[i])*(f[i]*f[i]),a+=l[i]*r[i]+s[i]*t[i]}return a},lagrange:function(n,r,t){for(var e,o,u=0,a=0,i=n.length;a<i;a++){for(o=r[a],e=0;e<i;e++)a!=e&&(o*=(t-n[e])/(n[a]-n[e]));u+=o}return u},cubic_spline:function(r,t,e){for(var o,u,a=r.length,i=0,f=[],c=[],l=[],s=[],p=[],d=[];i<a-1;i++)s[i]=r[i+1]-r[i];for(l[0]=0,i=1;i<a-1;i++)l[i]=3/s[i]*(t[i+1]-t[i])-3/s[i-1]*(t[i]-t[i-1]);for(i=1;i<a-1;i++)f[i]=[],c[i]=[],f[i][i-1]=s[i-1],f[i][i]=2*(s[i-1]+s[i]),f[i][i+1]=s[i],c[i][0]=l[i];for(u=n.multiply(n.inv(f),c),o=0;o<a-1;o++)p[o]=(t[o+1]-t[o])/s[o]-s[o]*(u[o+1][0]+2*u[o][0])/3,d[o]=(u[o+1][0]-u[o][0])/(3*s[o]);for(o=0;o<a&&!(r[o]>e);o++);return t[o-=1]+(e-r[o])*p[o]+n.sq(e-r[o])*u[o]+(e-r[o])*n.sq(e-r[o])*d[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(r){var t,e,o,u,a,i=r.length,f=r[0].length,c=0,l=[],s=[],p=[],d=[],h=[],m=[],v=[];for(c=0;c<i;c++)l[c]=n.sum(r[c])/f;for(c=0;c<f;c++)for(h[c]=[],t=0;t<i;t++)h[c][t]=r[t][c]-l[t];for(h=n.transpose(h),c=0;c<i;c++)for(m[c]=[],t=0;t<i;t++)m[c][t]=n.dot([h[c]],[h[t]])/(f-1);for(a=(o=n.jacobi(m))[0],s=o[1],v=n.transpose(a),c=0;c<s.length;c++)for(t=c;t<s.length;t++)s[c]<s[t]&&(e=s[c],s[c]=s[t],s[t]=e,p=v[c],v[c]=v[t],v[t]=p);for(u=n.transpose(h),c=0;c<i;c++)for(d[c]=[],t=0;t<u.length;t++)d[c][t]=n.dot([v[c]],[u[t]]);return[r,s,v,d]}}),function(r){for(var t=0;t<r.length;t++)!function(r){n.fn[r]=function(t,e){var o=this;return e?(setTimeout((function(){e.call(o,n.fn[r].call(o,t))}),15),this):"number"===typeof n[r](this,t)?n[r](this,t):n(n[r](this,t))}}(r[t])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(n,Math),function(n,r){var t=[].slice,e=n.utils.isNumber,o=n.utils.isArray;function u(n,t,e,o){if(n>1||e>1||n<=0||e<=0)throw new Error("Proportions should be greater than 0 and less than 1");var u=(n*t+e*o)/(t+o);return(n-e)/r.sqrt(u*(1-u)*(1/t+1/o))}n.extend({zscore:function(){var r=t.call(arguments);return e(r[1])?(r[0]-r[1])/r[2]:(r[0]-n.mean(r[1]))/n.stdev(r[1],r[2])},ztest:function(){var e,u=t.call(arguments);return o(u[1])?(e=n.zscore(u[0],u[1],u[3]),1===u[2]?n.normal.cdf(-r.abs(e),0,1):2*n.normal.cdf(-r.abs(e),0,1)):u.length>2?(e=n.zscore(u[0],u[1],u[2]),1===u[3]?n.normal.cdf(-r.abs(e),0,1):2*n.normal.cdf(-r.abs(e),0,1)):(e=u[0],1===u[1]?n.normal.cdf(-r.abs(e),0,1):2*n.normal.cdf(-r.abs(e),0,1))}}),n.extend(n.fn,{zscore:function(n,r){return(n-this.mean())/this.stdev(r)},ztest:function(t,e,o){var u=r.abs(this.zscore(t,o));return 1===e?n.normal.cdf(-u,0,1):2*n.normal.cdf(-u,0,1)}}),n.extend({tscore:function(){var e=t.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/r.sqrt(e[3])):(e[0]-n.mean(e[1]))/(n.stdev(e[1],!0)/r.sqrt(e[1].length))},ttest:function(){var o,u=t.call(arguments);return 5===u.length?(o=r.abs(n.tscore(u[0],u[1],u[2],u[3])),1===u[4]?n.studentt.cdf(-o,u[3]-1):2*n.studentt.cdf(-o,u[3]-1)):e(u[1])?(o=r.abs(u[0]),1==u[2]?n.studentt.cdf(-o,u[1]-1):2*n.studentt.cdf(-o,u[1]-1)):(o=r.abs(n.tscore(u[0],u[1])),1==u[2]?n.studentt.cdf(-o,u[1].length-1):2*n.studentt.cdf(-o,u[1].length-1))}}),n.extend(n.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/r.sqrt(this.cols()))},ttest:function(t,e){return 1===e?1-n.studentt.cdf(r.abs(this.tscore(t)),this.cols()-1):2*n.studentt.cdf(-r.abs(this.tscore(t)),this.cols()-1)}}),n.extend({anovafscore:function(){var e,o,u,a,i,f,c,l,s=t.call(arguments);if(1===s.length){for(i=new Array(s[0].length),c=0;c<s[0].length;c++)i[c]=s[0][c];s=i}for(o=new Array,c=0;c<s.length;c++)o=o.concat(s[c]);for(u=n.mean(o),e=0,c=0;c<s.length;c++)e+=s[c].length*r.pow(n.mean(s[c])-u,2);for(e/=s.length-1,f=0,c=0;c<s.length;c++)for(a=n.mean(s[c]),l=0;l<s[c].length;l++)f+=r.pow(s[c][l]-a,2);return e/(f/=o.length-s.length)},anovaftest:function(){var r,o,u,a,i=t.call(arguments);if(e(i[0]))return 1-n.centralF.cdf(i[0],i[1],i[2]);var f=n.anovafscore(i);for(r=i.length-1,u=0,a=0;a<i.length;a++)u+=i[a].length;return o=u-r-1,1-n.centralF.cdf(f,r,o)},ftest:function(r,t,e){return 1-n.centralF.cdf(r,t,e)}}),n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftes:function(){var r,t=0;for(r=0;r<this.length;r++)t+=this[r].length;return n.ftest(this.anovafscore(),this.length-1,t-this.length)}}),n.extend({qscore:function(){var o,u,a,i,f,c=t.call(arguments);return e(c[0])?(o=c[0],u=c[1],a=c[2],i=c[3],f=c[4]):(o=n.mean(c[0]),u=n.mean(c[1]),a=c[0].length,i=c[1].length,f=c[2]),r.abs(o-u)/(f*r.sqrt((1/a+1/i)/2))},qtest:function(){var r,e=t.call(arguments);3===e.length?(r=e[0],e=e.slice(1)):7===e.length?(r=n.qscore(e[0],e[1],e[2],e[3],e[4]),e=e.slice(5)):(r=n.qscore(e[0],e[1],e[2]),e=e.slice(3));var o=e[0],u=e[1];return 1-n.tukey.cdf(r,u,o-u)},tukeyhsd:function(r){for(var t=n.pooledstdev(r),e=r.map((function(r){return n.mean(r)})),o=r.reduce((function(n,r){return n+r.length}),0),u=[],a=0;a<r.length;++a)for(var i=a+1;i<r.length;++i){var f=n.qtest(e[a],e[i],r[a].length,r[i].length,t,o,r.length);u.push([[a,i],f])}return u}}),n.extend({normalci:function(){var e,o=t.call(arguments),u=new Array(2);return e=4===o.length?r.abs(n.normal.inv(o[1]/2,0,1)*o[2]/r.sqrt(o[3])):r.abs(n.normal.inv(o[1]/2,0,1)*n.stdev(o[2])/r.sqrt(o[2].length)),u[0]=o[0]-e,u[1]=o[0]+e,u},tci:function(){var e,o=t.call(arguments),u=new Array(2);return e=4===o.length?r.abs(n.studentt.inv(o[1]/2,o[3]-1)*o[2]/r.sqrt(o[3])):r.abs(n.studentt.inv(o[1]/2,o[2].length-1)*n.stdev(o[2],!0)/r.sqrt(o[2].length)),u[0]=o[0]-e,u[1]=o[0]+e,u},significant:function(n,r){return n<r}}),n.extend(n.fn,{normalci:function(r,t){return n.normalci(r,t,this.toArray())},tci:function(r,t){return n.tci(r,t,this.toArray())}}),n.extend(n.fn,{oneSidedDifferenceOfProportions:function(r,t,e,o){var a=u(r,t,e,o);return n.ztest(a,1)},twoSidedDifferenceOfProportions:function(r,t,e,o){var a=u(r,t,e,o);return n.ztest(a,2)}})}(n,Math),n.models=function(){function r(r,t){var e=r.length,o=t[0].length-1,u=e-o-1,a=n.lstsq(t,r),i=n.multiply(t,a.map((function(n){return[n]}))).map((function(n){return n[0]})),f=n.subtract(r,i),c=n.mean(r),l=n.sum(i.map((function(n){return Math.pow(n-c,2)}))),s=n.sum(r.map((function(n,r){return Math.pow(n-i[r],2)}))),p=l+s;return{exog:t,endog:r,nobs:e,df_model:o,df_resid:u,coef:a,predict:i,resid:f,ybar:c,SST:p,SSE:l,SSR:s,R2:l/p}}function t(t){var e=function(t){var e=t[0].length;return n.arange(e).map((function(o){var u=n.arange(e).filter((function(n){return n!==o}));return r(n.col(t,o).map((function(n){return n[0]})),n.col(t,u))}))}(t.exog),o=Math.sqrt(t.SSR/t.df_resid),u=e.map((function(n){var r=n.SST,t=n.R2;return o/Math.sqrt(r*(1-t))})),a=t.coef.map((function(n,r){return(n-0)/u[r]})),i=a.map((function(r){var e=n.studentt.cdf(r,t.df_resid);return 2*(e>.5?1-e:e)})),f=n.studentt.inv(.975,t.df_resid),c=t.coef.map((function(n,r){var t=f*u[r];return[n-t,n+t]}));return{se:u,t:a,p:i,sigmaHat:o,interval95:c}}return{ols:function(e,o){var u=r(e,o),a=t(u),i=function(r){var t,e,o,u=r.R2/r.df_model/((1-r.R2)/r.df_resid);return{F_statistic:u,pvalue:1-(t=u,e=r.df_model,o=r.df_resid,n.beta.cdf(t/(o/e+t),e/2,o/2))}}(u),f=1-(1-u.R2)*((u.nobs-1)/u.df_resid);return u.t=a,u.f=i,u.adjust_R2=f,u}}}(),n.extend({buildxmatrix:function(){for(var r=new Array(arguments.length),t=0;t<arguments.length;t++){var e=[1];r[t]=e.concat(arguments[t])}return n(r)},builddxmatrix:function(){for(var r=new Array(arguments[0].length),t=0;t<arguments[0].length;t++){var e=[1];r[t]=e.concat(arguments[0][t])}return n(r)},buildjxmatrix:function(r){for(var t=new Array(r.length),e=0;e<r.length;e++)t[e]=r[e];return n.builddxmatrix(t)},buildymatrix:function(r){return n(r).transpose()},buildjymatrix:function(n){return n.transpose()},matrixmult:function(r,t){var e,o,u,a,i;if(r.cols()==t.rows()){if(t.rows()>1){for(a=[],e=0;e<r.rows();e++)for(a[e]=[],o=0;o<t.cols();o++){for(i=0,u=0;u<r.cols();u++)i+=r.toArray()[e][u]*t.toArray()[u][o];a[e][o]=i}return n(a)}for(a=[],e=0;e<r.rows();e++)for(a[e]=[],o=0;o<t.cols();o++){for(i=0,u=0;u<r.cols();u++)i+=r.toArray()[e][u]*t.toArray()[o];a[e][o]=i}return n(a)}},regress:function(r,t){var e=n.xtranspxinv(r),o=r.transpose(),u=n.matrixmult(n(e),o);return n.matrixmult(u,t)},regresst:function(r,t,e){var o=n.regress(r,t),u={anova:{}},a=n.jMatYBar(r,o);u.yBar=a;var i=t.mean();u.anova.residuals=n.residuals(t,a),u.anova.ssr=n.ssr(a,i),u.anova.msr=u.anova.ssr/(r[0].length-1),u.anova.sse=n.sse(t,a),u.anova.mse=u.anova.sse/(t.length-(r[0].length-1)-1),u.anova.sst=n.sst(t,i),u.anova.mst=u.anova.sst/(t.length-1),u.anova.r2=1-u.anova.sse/u.anova.sst,u.anova.r2<0&&(u.anova.r2=0),u.anova.fratio=u.anova.msr/u.anova.mse,u.anova.pvalue=n.anovaftest(u.anova.fratio,r[0].length-1,t.length-(r[0].length-1)-1),u.anova.rmse=Math.sqrt(u.anova.mse),u.anova.r2adj=1-u.anova.mse/u.anova.mst,u.anova.r2adj<0&&(u.anova.r2adj=0),u.stats=new Array(r[0].length);for(var f,c,l,s=n.xtranspxinv(r),p=0;p<o.length;p++)f=Math.sqrt(u.anova.mse*Math.abs(s[p][p])),c=Math.abs(o[p]/f),l=n.ttest(c,t.length-r[0].length-1,e),u.stats[p]=[o[p],f,c,l];return u.regress=o,u},xtranspx:function(r){return n.matrixmult(r.transpose(),r)},xtranspxinv:function(r){var t=n.matrixmult(r.transpose(),r);return n.inv(t)},jMatYBar:function(r,t){var e=n.matrixmult(r,t);return new n(e)},residuals:function(r,t){return n.matrixsubtract(r,t)},ssr:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t},sse:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r[e],2);return t},sst:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t},matrixsubtract:function(r,t){for(var e=new Array(r.length),o=0;o<r.length;o++){e[o]=new Array(r[o].length);for(var u=0;u<r[o].length;u++)e[o][u]=r[o][u]-t[o][u]}return n(e)}}),n.jStat=n,n}()},function(n,r){n.exports=function(n,r,t){for(var e=t?n.map(t):n,o=t?r.map(t):r,u=0,a=0,i=0,f=0;f<e.length;f++)a+=e[f]*e[f],i+=o[f]*o[f],u+=e[f]*o[f];return u/(Math.sqrt(a)*Math.sqrt(i))}},function(n,r,t){var e=t(11),o={};o.bonferroni=function(n,r){for(var t=r||n.length,e=0;e<n.length;e++)n[e]=t*n[e]>1?1:t*n[e];return n},o.fdr=function(n,r){var t=e.clone(n);for(i=n.length;i--;)t[i]={k:i,v:n[i]};pvalues_sorted=t.sort((function(n,r){return n.v<r.v?-1:n.v>r.v?1:0}));var o=n.length;r=r||n.length,pvalues_sorted[o-1]=pvalues_sorted[o-1];for(var u=o-1;u>0;)pvalues_sorted[u-1].v=Math.min(pvalues_sorted[u].v,r/u*pvalues_sorted[u-1].v),u--;for(j=n.length,pvalues_sorted.sort((function(n,r){return n.k<r.k?-1:n.k>r.k?1:0}));j--;)pvalues_sorted[j]=pvalues_sorted[j].v;return pvalues_sorted},o.bY=function(n,r){var t=e.clone(n);for(i=n.length;i--;)t[i]={k:i,v:n[i]};pvalues_sorted=t.sort((function(n,r){return n.v<r.v?-1:n.v>r.v?1:0}));var o=n.length;r=r||n.length;for(var u=0,a=0;a<r;a++)u+=1/(1+a);pvalues_sorted[o-1].v=Math.min(1,u*pvalues_sorted[o-1].v);for(var f=o-1;f>0;)pvalues_sorted[f-1].v=Math.min(1,Math.min(u*pvalues_sorted[f].v,u*(r/f)*pvalues_sorted[f-1].v)),f--;for(j=n.length,pvalues_sorted.sort((function(n,r){return n.k<r.k?-1:n.k>r.k?1:0}));j--;)pvalues_sorted[j]=pvalues_sorted[j].v;return pvalues_sorted},o.adjustSignificanceLevel=function(n,r){var t=n.length,e=1/t*r;pvalues_sorted=n.sort((function(n,r){return n<r?-1:n>r?1:0}));for(var o=1;o<=pvalues_sorted.length;o++){if(pvalues_sorted[o-1]>o/t*r)break;e=o/t*r}return e},n.exports=o},function(n,r,t){var e=t(4),o=t(10);n.exports=function(){var n,r,t,u,a="position",i="angular",f=e.angular,c="avg",l=!1;function s(){}return s.data=function(r){return arguments.length?(n=r,s._buildTree(),s):n},s.posKey=function(n){return arguments.length?(a=n,s):a},s.linkage=function(n){return arguments.length?(c=n,s):c},s.verbose=function(n){return arguments.length?(l=n,s):l},s.distance=function(n){return arguments.length?(i=n,f={angular:e.angular,euclidean:e.euclidean}[n]||e.angular,s):i},s.orderedNodes=function(){if(!u)throw new Error("Need to passin data and build tree first.");return u.indexes.map((function(r){return n[r]}))},s.tree=function(){if(!u)throw new Error("Need to passin data and build tree first.");return u},s.getClusters=function(r){if(!u)throw new Error("Need to passin data and build tree first.");if(r>n.length)throw new Error("n must be less than the size of the dataset");return t[n.length-r].map((function(r){return r.map((function(r){return n[r]}))}))},s._squareMatrixPairs=function(n){for(var r=[],t=0;t<n;t++)for(var e=t+1;e<n;e++)r.push([t,e]);return r},s._avgDistance=function(r,t){for(var e=0,o=0;o<r.length;o++)for(var u=0;u<t.length;u++)e+=n[r[o]]._distances[t[u]];return e/r.length/t.length},s._minDistance=function(r,t){for(var e=[],o=0;o<r.length;o++)for(var u=0;u<t.length;u++)e.push(n[r[o]]._distances[t[u]]);return e.sort()[0]},s._maxDistance=function(r,t){for(var e=[],o=0;o<r.length;o++)for(var u=0;u<t.length;u++)e.push(n[r[o]]._distances[t[u]]);return e.sort()[e.length-1]},s._buildTree=function(){if(!n||!n.length)throw new Error("Need `data` to build tree");var e,i,p;r=[],t=[],tree={},n.forEach((function(t,e){t._distances=n.map((function(n){return f(t[a],n[a])})),r.push(o(t,{height:0,indexes:[e]}))}));for(var d=0;d<n.length-1;d++)l&&console.log(d+": "+r.map((function(n){return n.indexes})).join("|")),(e=s._squareMatrixPairs(r.length)).forEach((function(n){n[2]=s["_"+c+"Distance"](r[n[0]].indexes,r[n[1]].indexes)})),p={name:"Node "+d,height:(i=e.reduce((function(n,r){return n[2]<=r[2]?n:r}),[0,0,1/0]))[2],indexes:r[i[0]].indexes.concat(r[i[1]].indexes),children:[r[i[0]],r[i[1]]]},l&&console.log(p),t.push(r.map((function(n){return n.indexes}))),r.splice(Math.max(i[0],i[1]),1),r.splice(Math.min(i[0],i[1]),1),r.push(p);u=r[0]},s}},function(n,r,t){n.exports={euclidean:t(5),manhattan:t(6),chebyshev:t(7),angular:t(8),cosineSimilarity:t(1),angularSimilarity:t(9)}},function(n,r){n.exports=function(n,r,t){for(var e=t?n.map(t):n,o=t?r.map(t):r,u=0,a=0;a<e.length;a++)u+=(e[a]-o[a])*(e[a]-o[a]);return Math.sqrt(u)}},function(n,r){n.exports=function(n,r,t){for(var e=t?n.map(t):n,o=t?r.map(t):r,u=0,a=0;a<e.length;a++)u+=Math.abs(e[a]-o[a]);return u}},function(n,r){n.exports=function(n,r,t){for(var e=t?n.map(t):n,o=t?r.map(t):r,u=Math.abs(e[0]-o[0]),a=1;a<e.length;a++)u=Math.max(u,Math.abs(e[a]-o[a]));return u}},function(n,r,t){var e=t(1);n.exports=function(n,r,t){var o=e.apply(null,arguments);return 2*Math.acos(o)/Math.PI}},function(n,r,t){var e=t(1);n.exports=function(n,r,t){var o=e.apply(null,arguments);return 1-2*Math.acos(o)/Math.PI}},function(n,r,t){"use strict";var e=Object.prototype.hasOwnProperty,o=Object.prototype.toString,u=Object.defineProperty,a=Object.getOwnPropertyDescriptor,i=function(n){return"function"===typeof Array.isArray?Array.isArray(n):"[object Array]"===o.call(n)},f=function(n){if(!n||"[object Object]"!==o.call(n))return!1;var r,t=e.call(n,"constructor"),u=n.constructor&&n.constructor.prototype&&e.call(n.constructor.prototype,"isPrototypeOf");if(n.constructor&&!t&&!u)return!1;for(r in n);return"undefined"===typeof r||e.call(n,r)},c=function(n,r){u&&"__proto__"===r.name?u(n,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):n[r.name]=r.newValue},l=function(n,r){if("__proto__"===r){if(!e.call(n,r))return;if(a)return a(n,r).value}return n[r]};n.exports=function n(){var r,t,e,o,u,a,s=arguments[0],p=1,d=arguments.length,h=!1;for("boolean"===typeof s&&(h=s,s=arguments[1]||{},p=2),(null==s||"object"!==typeof s&&"function"!==typeof s)&&(s={});p<d;++p)if(null!=(r=arguments[p]))for(t in r)e=l(s,t),s!==(o=l(r,t))&&(h&&o&&(f(o)||(u=i(o)))?(u?(u=!1,a=e&&i(e)?e:[]):a=e&&f(e)?e:{},c(s,{name:t,newValue:n(h,a,o)})):"undefined"!==typeof o&&c(s,{name:t,newValue:o}));return s}},function(n,r,t){(function(n,t){var e;!function(){var o="object"==typeof self&&self.self===self&&self||"object"==typeof n&&n.global===n&&n||this||{},u=o._,a=Array.prototype,i=Object.prototype,f="undefined"!==typeof Symbol?Symbol.prototype:null,c=a.push,l=a.slice,s=i.toString,p=i.hasOwnProperty,d=Array.isArray,h=Object.keys,m=Object.create,v=function(){},g=function n(r){return r instanceof n?r:this instanceof n?void(this._wrapped=r):new n(r)};r.nodeType?o._=g:(!t.nodeType&&t.exports&&(r=t.exports=g),r._=g),g.VERSION="1.9.2";var y,b=function(n,r,t){if(void 0===r)return n;switch(null==t?3:t){case 1:return function(t){return n.call(r,t)};case 3:return function(t,e,o){return n.call(r,t,e,o)};case 4:return function(t,e,o,u){return n.call(r,t,e,o,u)}}return function(){return n.apply(r,arguments)}},w=function(n,r,t){return g.iteratee!==y?g.iteratee(n,r):null==n?g.identity:g.isFunction(n)?b(n,r,t):g.isObject(n)&&!g.isArray(n)?g.matcher(n):g.property(n)};g.iteratee=y=function(n,r){return w(n,r,1/0)};var x=function(n,r){return r=null==r?n.length-1:+r,function(){for(var t=Math.max(arguments.length-r,0),e=Array(t),o=0;o<t;o++)e[o]=arguments[o+r];switch(r){case 0:return n.call(this,e);case 1:return n.call(this,arguments[0],e);case 2:return n.call(this,arguments[0],arguments[1],e)}var u=Array(r+1);for(o=0;o<r;o++)u[o]=arguments[o];return u[r]=e,n.apply(this,u)}},_=function(n){if(!g.isObject(n))return{};if(m)return m(n);v.prototype=n;var r=new v;return v.prototype=null,r},j=function(n){return function(r){return null==r?void 0:r[n]}},A=function(n,r){return null!=n&&p.call(n,r)},q=function(n,r){for(var t=r.length,e=0;e<t;e++){if(null==n)return;n=n[r[e]]}return t?n:void 0},M=Math.pow(2,53)-1,O=j("length"),k=function(n){var r=O(n);return"number"==typeof r&&r>=0&&r<=M};g.each=g.forEach=function(n,r,t){var e,o;if(r=b(r,t),k(n))for(e=0,o=n.length;e<o;e++)r(n[e],e,n);else{var u=g.keys(n);for(e=0,o=u.length;e<o;e++)r(n[u[e]],u[e],n)}return n},g.map=g.collect=function(n,r,t){r=w(r,t);for(var e=!k(n)&&g.keys(n),o=(e||n).length,u=Array(o),a=0;a<o;a++){var i=e?e[a]:a;u[a]=r(n[i],i,n)}return u};var S=function(n){var r=function(r,t,e,o){var u=!k(r)&&g.keys(r),a=(u||r).length,i=n>0?0:a-1;for(o||(e=r[u?u[i]:i],i+=n);i>=0&&i<a;i+=n){var f=u?u[i]:i;e=t(e,r[f],f,r)}return e};return function(n,t,e,o){var u=arguments.length>=3;return r(n,b(t,o,4),e,u)}};g.reduce=g.foldl=g.inject=S(1),g.reduceRight=g.foldr=S(-1),g.find=g.detect=function(n,r,t){var e=(k(n)?g.findIndex:g.findKey)(n,r,t);if(void 0!==e&&-1!==e)return n[e]},g.filter=g.select=function(n,r,t){var e=[];return r=w(r,t),g.each(n,(function(n,t,o){r(n,t,o)&&e.push(n)})),e},g.reject=function(n,r,t){return g.filter(n,g.negate(w(r)),t)},g.every=g.all=function(n,r,t){r=w(r,t);for(var e=!k(n)&&g.keys(n),o=(e||n).length,u=0;u<o;u++){var a=e?e[u]:u;if(!r(n[a],a,n))return!1}return!0},g.some=g.any=function(n,r,t){r=w(r,t);for(var e=!k(n)&&g.keys(n),o=(e||n).length,u=0;u<o;u++){var a=e?e[u]:u;if(r(n[a],a,n))return!0}return!1},g.contains=g.includes=g.include=function(n,r,t,e){return k(n)||(n=g.values(n)),("number"!=typeof t||e)&&(t=0),g.indexOf(n,r,t)>=0},g.invoke=x((function(n,r,t){var e,o;return g.isFunction(r)?o=r:g.isArray(r)&&(e=r.slice(0,-1),r=r[r.length-1]),g.map(n,(function(n){var u=o;if(!u){if(e&&e.length&&(n=q(n,e)),null==n)return;u=n[r]}return null==u?u:u.apply(n,t)}))})),g.pluck=function(n,r){return g.map(n,g.property(r))},g.where=function(n,r){return g.filter(n,g.matcher(r))},g.findWhere=function(n,r){return g.find(n,g.matcher(r))},g.max=function(n,r,t){var e,o,u=-1/0,a=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var i=0,f=(n=k(n)?n:g.values(n)).length;i<f;i++)null!=(e=n[i])&&e>u&&(u=e);else r=w(r,t),g.each(n,(function(n,t,e){((o=r(n,t,e))>a||o===-1/0&&u===-1/0)&&(u=n,a=o)}));return u},g.min=function(n,r,t){var e,o,u=1/0,a=1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var i=0,f=(n=k(n)?n:g.values(n)).length;i<f;i++)null!=(e=n[i])&&e<u&&(u=e);else r=w(r,t),g.each(n,(function(n,t,e){((o=r(n,t,e))<a||o===1/0&&u===1/0)&&(u=n,a=o)}));return u},g.shuffle=function(n){return g.sample(n,1/0)},g.sample=function(n,r,t){if(null==r||t)return k(n)||(n=g.values(n)),n[g.random(n.length-1)];var e=k(n)?g.clone(n):g.values(n),o=O(e);r=Math.max(Math.min(r,o),0);for(var u=o-1,a=0;a<r;a++){var i=g.random(a,u),f=e[a];e[a]=e[i],e[i]=f}return e.slice(0,r)},g.sortBy=function(n,r,t){var e=0;return r=w(r,t),g.pluck(g.map(n,(function(n,t,o){return{value:n,index:e++,criteria:r(n,t,o)}})).sort((function(n,r){var t=n.criteria,e=r.criteria;if(t!==e){if(t>e||void 0===t)return 1;if(t<e||void 0===e)return-1}return n.index-r.index})),"value")};var N=function(n,r){return function(t,e,o){var u=r?[[],[]]:{};return e=w(e,o),g.each(t,(function(r,o){var a=e(r,o,t);n(u,r,a)})),u}};g.groupBy=N((function(n,r,t){A(n,t)?n[t].push(r):n[t]=[r]})),g.indexBy=N((function(n,r,t){n[t]=r})),g.countBy=N((function(n,r,t){A(n,t)?n[t]++:n[t]=1}));var P=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;g.toArray=function(n){return n?g.isArray(n)?l.call(n):g.isString(n)?n.match(P):k(n)?g.map(n,g.identity):g.values(n):[]},g.size=function(n){return null==n?0:k(n)?n.length:g.keys(n).length},g.partition=N((function(n,r,t){n[t?0:1].push(r)}),!0),g.first=g.head=g.take=function(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[0]:g.initial(n,n.length-r)},g.initial=function(n,r,t){return l.call(n,0,Math.max(0,n.length-(null==r||t?1:r)))},g.last=function(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[n.length-1]:g.rest(n,Math.max(0,n.length-r))},g.rest=g.tail=g.drop=function(n,r,t){return l.call(n,null==r||t?1:r)},g.compact=function(n){return g.filter(n,Boolean)};var E=function n(r,t,e,o){for(var u=(o=o||[]).length,a=0,i=O(r);a<i;a++){var f=r[a];if(k(f)&&(g.isArray(f)||g.isArguments(f)))if(t)for(var c=0,l=f.length;c<l;)o[u++]=f[c++];else n(f,t,e,o),u=o.length;else e||(o[u++]=f)}return o};g.flatten=function(n,r){return E(n,r,!1)},g.without=x((function(n,r){return g.difference(n,r)})),g.uniq=g.unique=function(n,r,t,e){g.isBoolean(r)||(e=t,t=r,r=!1),null!=t&&(t=w(t,e));for(var o=[],u=[],a=0,i=O(n);a<i;a++){var f=n[a],c=t?t(f,a,n):f;r&&!t?(a&&u===c||o.push(f),u=c):t?g.contains(u,c)||(u.push(c),o.push(f)):g.contains(o,f)||o.push(f)}return o},g.union=x((function(n){return g.uniq(E(n,!0,!0))})),g.intersection=function(n){for(var r=[],t=arguments.length,e=0,o=O(n);e<o;e++){var u=n[e];if(!g.contains(r,u)){var a;for(a=1;a<t&&g.contains(arguments[a],u);a++);a===t&&r.push(u)}}return r},g.difference=x((function(n,r){return r=E(r,!0,!0),g.filter(n,(function(n){return!g.contains(r,n)}))})),g.unzip=function(n){for(var r=n&&g.max(n,O).length||0,t=Array(r),e=0;e<r;e++)t[e]=g.pluck(n,e);return t},g.zip=x(g.unzip),g.object=function(n,r){for(var t={},e=0,o=O(n);e<o;e++)r?t[n[e]]=r[e]:t[n[e][0]]=n[e][1];return t};var I=function(n){return function(r,t,e){t=w(t,e);for(var o=O(r),u=n>0?0:o-1;u>=0&&u<o;u+=n)if(t(r[u],u,r))return u;return-1}};g.findIndex=I(1),g.findLastIndex=I(-1),g.sortedIndex=function(n,r,t,e){for(var o=(t=w(t,e,1))(r),u=0,a=O(n);u<a;){var i=Math.floor((u+a)/2);t(n[i])<o?u=i+1:a=i}return u};var R=function(n,r,t){return function(e,o,u){var a=0,i=O(e);if("number"==typeof u)n>0?a=u>=0?u:Math.max(u+i,a):i=u>=0?Math.min(u+1,i):u+i+1;else if(t&&u&&i)return e[u=t(e,o)]===o?u:-1;if(o!==o)return(u=r(l.call(e,a,i),g.isNaN))>=0?u+a:-1;for(u=n>0?a:i-1;u>=0&&u<i;u+=n)if(e[u]===o)return u;return-1}};g.indexOf=R(1,g.findIndex,g.sortedIndex),g.lastIndexOf=R(-1,g.findLastIndex),g.range=function(n,r,t){null==r&&(r=n||0,n=0),t||(t=r<n?-1:1);for(var e=Math.max(Math.ceil((r-n)/t),0),o=Array(e),u=0;u<e;u++,n+=t)o[u]=n;return o},g.chunk=function(n,r){if(null==r||r<1)return[];for(var t=[],e=0,o=n.length;e<o;)t.push(l.call(n,e,e+=r));return t};var F=function(n,r,t,e,o){if(!(e instanceof r))return n.apply(t,o);var u=_(n.prototype),a=n.apply(u,o);return g.isObject(a)?a:u};g.bind=x((function(n,r,t){if(!g.isFunction(n))throw new TypeError("Bind must be called on a function");var e=x((function(o){return F(n,e,r,this,t.concat(o))}));return e})),g.partial=x((function(n,r){var t=g.partial.placeholder;return function e(){for(var o=0,u=r.length,a=Array(u),i=0;i<u;i++)a[i]=r[i]===t?arguments[o++]:r[i];for(;o<arguments.length;)a.push(arguments[o++]);return F(n,e,this,this,a)}})),g.partial.placeholder=g,g.bindAll=x((function(n,r){var t=(r=E(r,!1,!1)).length;if(t<1)throw new Error("bindAll must be passed function names");for(;t--;){var e=r[t];n[e]=g.bind(n[e],n)}})),g.memoize=function(n,r){var t=function t(e){var o=t.cache,u=""+(r?r.apply(this,arguments):e);return A(o,u)||(o[u]=n.apply(this,arguments)),o[u]};return t.cache={},t},g.delay=x((function(n,r,t){return setTimeout((function(){return n.apply(null,t)}),r)})),g.defer=g.partial(g.delay,g,1),g.throttle=function(n,r,t){var e,o,u,a,i=0;t||(t={});var f=function(){i=!1===t.leading?0:g.now(),e=null,a=n.apply(o,u),e||(o=u=null)},c=function(){var c=g.now();i||!1!==t.leading||(i=c);var l=r-(c-i);return o=this,u=arguments,l<=0||l>r?(e&&(clearTimeout(e),e=null),i=c,a=n.apply(o,u),e||(o=u=null)):e||!1===t.trailing||(e=setTimeout(f,l)),a};return c.cancel=function(){clearTimeout(e),i=0,e=o=u=null},c},g.debounce=function(n,r,t){var e,o,u=function(r,t){e=null,t&&(o=n.apply(r,t))},a=x((function(a){if(e&&clearTimeout(e),t){var i=!e;e=setTimeout(u,r),i&&(o=n.apply(this,a))}else e=g.delay(u,r,this,a);return o}));return a.cancel=function(){clearTimeout(e),e=null},a},g.wrap=function(n,r){return g.partial(r,n)},g.negate=function(n){return function(){return!n.apply(this,arguments)}},g.compose=function(){var n=arguments,r=n.length-1;return function(){for(var t=r,e=n[r].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},g.after=function(n,r){return function(){if(--n<1)return r.apply(this,arguments)}},g.before=function(n,r){var t;return function(){return--n>0&&(t=r.apply(this,arguments)),n<=1&&(r=null),t}},g.once=g.partial(g.before,2),g.restArguments=x;var T=!{toString:null}.propertyIsEnumerable("toString"),z=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],D=function(n,r){var t=z.length,e=n.constructor,o=g.isFunction(e)&&e.prototype||i,u="constructor";for(A(n,u)&&!g.contains(r,u)&&r.push(u);t--;)(u=z[t])in n&&n[u]!==o[u]&&!g.contains(r,u)&&r.push(u)};g.keys=function(n){if(!g.isObject(n))return[];if(h)return h(n);var r=[];for(var t in n)A(n,t)&&r.push(t);return T&&D(n,r),r},g.allKeys=function(n){if(!g.isObject(n))return[];var r=[];for(var t in n)r.push(t);return T&&D(n,r),r},g.values=function(n){for(var r=g.keys(n),t=r.length,e=Array(t),o=0;o<t;o++)e[o]=n[r[o]];return e},g.mapObject=function(n,r,t){r=w(r,t);for(var e=g.keys(n),o=e.length,u={},a=0;a<o;a++){var i=e[a];u[i]=r(n[i],i,n)}return u},g.pairs=function(n){for(var r=g.keys(n),t=r.length,e=Array(t),o=0;o<t;o++)e[o]=[r[o],n[r[o]]];return e},g.invert=function(n){for(var r={},t=g.keys(n),e=0,o=t.length;e<o;e++)r[n[t[e]]]=t[e];return r},g.functions=g.methods=function(n){var r=[];for(var t in n)g.isFunction(n[t])&&r.push(t);return r.sort()};var G=function(n,r){return function(t){var e=arguments.length;if(r&&(t=Object(t)),e<2||null==t)return t;for(var o=1;o<e;o++)for(var u=arguments[o],a=n(u),i=a.length,f=0;f<i;f++){var c=a[f];r&&void 0!==t[c]||(t[c]=u[c])}return t}};g.extend=G(g.allKeys),g.extendOwn=g.assign=G(g.keys),g.findKey=function(n,r,t){r=w(r,t);for(var e,o=g.keys(n),u=0,a=o.length;u<a;u++)if(r(n[e=o[u]],e,n))return e};var V,B,L=function(n,r,t){return r in t};g.pick=x((function(n,r){var t={},e=r[0];if(null==n)return t;g.isFunction(e)?(r.length>1&&(e=b(e,r[1])),r=g.allKeys(n)):(e=L,r=E(r,!1,!1),n=Object(n));for(var o=0,u=r.length;o<u;o++){var a=r[o],i=n[a];e(i,a,n)&&(t[a]=i)}return t})),g.omit=x((function(n,r){var t,e=r[0];return g.isFunction(e)?(e=g.negate(e),r.length>1&&(t=r[1])):(r=g.map(E(r,!1,!1),String),e=function(n,t){return!g.contains(r,t)}),g.pick(n,e,t)})),g.defaults=G(g.allKeys,!0),g.create=function(n,r){var t=_(n);return r&&g.extendOwn(t,r),t},g.clone=function(n){return g.isObject(n)?g.isArray(n)?n.slice():g.extend({},n):n},g.tap=function(n,r){return r(n),n},g.isMatch=function(n,r){var t=g.keys(r),e=t.length;if(null==n)return!e;for(var o=Object(n),u=0;u<e;u++){var a=t[u];if(r[a]!==o[a]||!(a in o))return!1}return!0},V=function(n,r,t,e){if(n===r)return 0!==n||1/n===1/r;if(null==n||null==r)return!1;if(n!==n)return r!==r;var o=typeof n;return("function"===o||"object"===o||"object"==typeof r)&&B(n,r,t,e)},B=function(n,r,t,e){n instanceof g&&(n=n._wrapped),r instanceof g&&(r=r._wrapped);var o=s.call(n);if(o!==s.call(r))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+n===""+r;case"[object Number]":return+n!==+n?+r!==+r:0===+n?1/+n===1/r:+n===+r;case"[object Date]":case"[object Boolean]":return+n===+r;case"[object Symbol]":return f.valueOf.call(n)===f.valueOf.call(r)}var u="[object Array]"===o;if(!u){if("object"!=typeof n||"object"!=typeof r)return!1;var a=n.constructor,i=r.constructor;if(a!==i&&!(g.isFunction(a)&&a instanceof a&&g.isFunction(i)&&i instanceof i)&&"constructor"in n&&"constructor"in r)return!1}e=e||[];for(var c=(t=t||[]).length;c--;)if(t[c]===n)return e[c]===r;if(t.push(n),e.push(r),u){if((c=n.length)!==r.length)return!1;for(;c--;)if(!V(n[c],r[c],t,e))return!1}else{var l,p=g.keys(n);if(c=p.length,g.keys(r).length!==c)return!1;for(;c--;)if(l=p[c],!A(r,l)||!V(n[l],r[l],t,e))return!1}return t.pop(),e.pop(),!0},g.isEqual=function(n,r){return V(n,r)},g.isEmpty=function(n){return null==n||(k(n)&&(g.isArray(n)||g.isString(n)||g.isArguments(n))?0===n.length:0===g.keys(n).length)},g.isElement=function(n){return!(!n||1!==n.nodeType)},g.isArray=d||function(n){return"[object Array]"===s.call(n)},g.isObject=function(n){var r=typeof n;return"function"===r||"object"===r&&!!n},g.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],(function(n){g["is"+n]=function(r){return s.call(r)==="[object "+n+"]"}})),g.isArguments(arguments)||(g.isArguments=function(n){return A(n,"callee")});var K=o.document&&o.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof K&&(g.isFunction=function(n){return"function"==typeof n||!1}),g.isFinite=function(n){return!g.isSymbol(n)&&isFinite(n)&&!isNaN(parseFloat(n))},g.isNaN=function(n){return g.isNumber(n)&&isNaN(n)},g.isBoolean=function(n){return!0===n||!1===n||"[object Boolean]"===s.call(n)},g.isNull=function(n){return null===n},g.isUndefined=function(n){return void 0===n},g.has=function(n,r){if(!g.isArray(r))return A(n,r);for(var t=r.length,e=0;e<t;e++){var o=r[e];if(null==n||!p.call(n,o))return!1;n=n[o]}return!!t},g.noConflict=function(){return o._=u,this},g.identity=function(n){return n},g.constant=function(n){return function(){return n}},g.noop=function(){},g.property=function(n){return g.isArray(n)?function(r){return q(r,n)}:j(n)},g.propertyOf=function(n){return null==n?function(){}:function(r){return g.isArray(r)?q(n,r):n[r]}},g.matcher=g.matches=function(n){return n=g.extendOwn({},n),function(r){return g.isMatch(r,n)}},g.times=function(n,r,t){var e=Array(Math.max(0,n));r=b(r,t,1);for(var o=0;o<n;o++)e[o]=r(o);return e},g.random=function(n,r){return null==r&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1))},g.now=Date.now||function(){return(new Date).getTime()};var C={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Q=g.invert(C),W=function(n){var r=function(r){return n[r]},t="(?:"+g.keys(n).join("|")+")",e=RegExp(t),o=RegExp(t,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(o,r):n}};g.escape=W(C),g.unescape=W(Q),g.result=function(n,r,t){g.isArray(r)||(r=[r]);var e=r.length;if(!e)return g.isFunction(t)?t.call(n):t;for(var o=0;o<e;o++){var u=null==n?void 0:n[r[o]];void 0===u&&(u=t,o=e),n=g.isFunction(u)?u.call(n):u}return n};var Y=0;g.uniqueId=function(n){var r=++Y+"";return n?n+r:r},g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var U=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},J=/\\|'|\r|\n|\u2028|\u2029/g,$=function(n){return"\\"+H[n]};g.template=function(n,r,t){!r&&t&&(r=t),r=g.defaults({},r,g.templateSettings);var e,o=RegExp([(r.escape||U).source,(r.interpolate||U).source,(r.evaluate||U).source].join("|")+"|$","g"),u=0,a="__p+='";n.replace(o,(function(r,t,e,o,i){return a+=n.slice(u,i).replace(J,$),u=i+r.length,t?a+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":e?a+="'+\n((__t=("+e+"))==null?'':__t)+\n'":o&&(a+="';\n"+o+"\n__p+='"),r})),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(c){throw c.source=a,c}var i=function(n){return e.call(this,n,g)},f=r.variable||"obj";return i.source="function("+f+"){\n"+a+"}",i},g.chain=function(n){var r=g(n);return r._chain=!0,r};var X=function(n,r){return n._chain?g(r).chain():r};g.mixin=function(n){return g.each(g.functions(n),(function(r){var t=g[r]=n[r];g.prototype[r]=function(){var n=[this._wrapped];return c.apply(n,arguments),X(this,t.apply(g,n))}})),g},g.mixin(g),g.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(n){var r=a[n];g.prototype[n]=function(){var t=this._wrapped;return r.apply(t,arguments),"shift"!==n&&"splice"!==n||0!==t.length||delete t[0],X(this,t)}})),g.each(["concat","join","slice"],(function(n){var r=a[n];g.prototype[n]=function(){return X(this,r.apply(this._wrapped,arguments))}})),g.prototype.value=function(){return this._wrapped},g.prototype.valueOf=g.prototype.toJSON=g.prototype.value,g.prototype.toString=function(){return String(this._wrapped)},void 0===(e=function(){return g}.apply(r,[]))||(t.exports=e)}()}).call(this,t(12),t(13)(n))},function(n,r){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"===typeof window&&(t=window)}n.exports=t},function(n,r){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),n.webpackPolyfill=1),n}},function(n,r,t){"use strict";function e(n,r,t){return r in n?Object.defineProperty(n,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[r]=t,n}function o(n){return function(n){if(Array.isArray(n)){for(var r=0,t=new Array(n.length);r<n.length;r++)t[r]=n[r];return t}}(n)||function(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(n,r){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);r&&(e=e.filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),t.push.apply(t,e)}return t}function a(n){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?u(Object(t),!0).forEach((function(r){e(n,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))}))}return n}t.r(r);var i=t(0),f=t.n(i),c=t(3),l=t.n(c),s=t(2),p=function(n){return Array.isArray(n)};t.d(r,"calculateEnrichedSignatures",(function(){return m})),t.d(r,"clusterData",(function(){return v})),t.d(r,"calculateVolcanoSignatures",(function(){return g}));var d=function(n){var r,t=0,e=0,o=!0,u=!1,a=void 0;try{for(var i,f=n[Symbol.iterator]();!(o=(i=f.next()).done);o=!0){var c=i.value;"number"!==typeof(r=c)||Number.isNaN(r)||(t++,e+=c)}}catch(l){u=!0,a=l}finally{try{o||null==f.return||f.return()}finally{if(u)throw a}}return t>0?e/t:0},h=function(n,r){for(var t=0,e=n-r+1;e<=n;e++)t+=Math.log(e);for(var o=1;o<=r;o++)t-=Math.log(o);return t},m=function(n){var r=n.selectedGenes,t=n.participations,e=n.geneList,o=n.signatureList;if(!p(r)||!r.length||!p(t)||!t.length||!p(e)||!e.length||!p(o)||!o.length)return[];var u=o.map((function(n){var e=t.filter((function(r){return r.signature===n.id})).map((function(n){return n.gene})),o=e.filter((function(n){return r.find((function(r){return r.id===n}))})).map((function(n){return r.find((function(r){return r.id===n}))}));return a({},n,{participatingGenes:e,matchedGenes:o})})).filter((function(n){return n.participatingGenes.length})).map((function(n){var t=e.length,o=r.length,u=n.participatingGenes.length;return a({},n,{pValue:1-function(n,r,t,e){for(var o=0,u=0;u<n;u++)o+=Math.exp(h(r,u)+h(e-r,t-u)-h(e,t));return o}(n.matchedGenes.length,o,u,t)})})),i=u.map((function(n){return n.pValue})),f=Object(s.fdr)(i);return u=u.map((function(n,r){return a({},n,{pValue:f[r]})}))},v=function(n,r,t){var u={},a=!0,i=!1,f=void 0;try{for(var c,s=n[Symbol.iterator]();!(a=(c=s.next()).done);a=!0){var p,d=c.value,h=d[r],m=d[t];u[h]||(u[h]=(e(p={},r,h),e(p,t,[]),p)),u[h][t].push(m)}}catch(v){i=!0,f=v}finally{try{a||null==s.return||s.return()}finally{if(i)throw f}}return u=o(Object.values(u)),(u=l()().distance("euclidean").linkage("avg").posKey(t).data(u)).orderedNodes().map((function(n){return n[r]}))},g=function(n){var r=n.signatureList,t=n.activities,e=n.diamondGroup,o=n.spadeGroup;if(!p(r)||!r.length||!p(t)||!t.length||!p(e)||e.length<2||!p(o)||o.length<2)return[];var u=function(n,r){return(t.find((function(t){return t.signature===n&&t.sample===r}))||{}).value},i=(r=r.filter((function(n){return t.find((function(r){return r.signature===n.id}))}))).map((function(n){var r=e.map((function(r){return u(n.id,r)})).filter((function(n){return n})),t=o.map((function(r){return u(n.id,r)})).filter((function(n){return n})),i=d(r)-d(t),f=y(r,t);return a({},n,{diamondActivities:r,spadeActivities:t,meanDiff:i,pValue:f})})),f=i.map((function(n){return n.pValue})),c=Object(s.fdr)(f);return i=i.map((function(n,r){return a({},n,{pValue:-Math.log10(c[r])})}))},y=function(n,r){var t=n.length,e=r.length,o=Math.pow(t,2),u=Math.pow(e,2),a=f.a.mean(n),i=f.a.mean(r),c=Math.pow(f.a.stdev(n,!0),2),l=Math.pow(f.a.stdev(r,!0),2),s=Math.pow(f.a.stdev(n,!0),4),p=Math.pow(f.a.stdev(r,!0),4),d=(a-i)/Math.sqrt(c/t+l/e),h=Math.pow(c/t+l/e,2),m=s/(o*(t-1))+p/(u*(e-1)),v=Math.round(h/m);return 2*f.a.studentt.cdf(-Math.abs(d),v)};addEventListener("message",(function(n){var t,e=n.data,o=e.type,u=e.method,a=e.id,i=e.params;"RPC"===o&&u&&((t=r[u])?Promise.resolve().then((function(){return t.apply(r,i)})):Promise.reject("No such method")).then((function(n){postMessage({type:"RPC",id:a,result:n})})).catch((function(n){var r={message:n};n.stack&&(r.message=n.message,r.stack=n.stack,r.name=n.name),postMessage({type:"RPC",id:a,error:r})}))})),postMessage({type:"RPC",method:"ready"})}]);
//# sourceMappingURL=f8505bd29efdb847a97a.worker.js.map